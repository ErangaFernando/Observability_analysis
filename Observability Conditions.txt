% System variables
syms x y z qx qy qz qw bx by bz vx vy vz T real % states
syms wx wy wz ft real % Inputs
syms kpa kpp real % drag coefficients
syms m g t real
syms p1x p1y p1z p2x p2y p2z p3x p3y p3z real
syms p4x p4y p4z real
syms ph th ps real
syms u real
syms k v real


Three range measurements
O3R = [	[                                                                                0,                                                                                0,                                                                                0,                                                                                                  -kpp,                                                                                                     0,                                                                                                     0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,   0]
		[                                                                                0,                                                                                0,                                                                                0,                                                                                                     0,                                                                                                  -kpp,                                                                                                     0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,   0]
		[                                                                                0,                                                                                0,                                                                                0,                                                                                                     0,                                                                                                     0,                                                                                                  -kpa,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,  -1]
		[                                                                          x - p1x,                                                                          y - p1y,                                                                          z - p1z,                                                                                                     0,                                                                                                     0,                                                                                                     0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,   0]
		[                                                                          x - p2x,                                                                          y - p2y,                                                                          z - p2z,                                                                                                     0,                                                                                                     0,                                                                                                     0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,   0]
		[                                                                          x - p3x,                                                                          y - p3y,                                                                          z - p3z,                                                                                                     0,                                                                                                     0,                                                                                                     0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,   0]
		[                                                                                0,                                                                                0,                                                                                0,                                                                                                 kpp^2,                                                                                                     0,                                                                                                     0,                                                                                                                 -2*g*kpp*qz,                                                                                                                 -2*g*kpp*qw,                                                                                                                 -2*g*kpp*qx,                                                                                                                   -2*g*kpp*qy,   0]
		[                                                                                0,                                                                                0,                                                                                0,                                                                                                     0,                                                                                                 kpp^2,                                                                                                     0,                                                                                                                  2*g*kpp*qw,                                                                                                                 -2*g*kpp*qz,                                                                                                                 -2*g*kpp*qy,                                                                                                                    2*g*kpp*qx,   0]
		[                                                                                0,                                                                                0,                                                                                0,                                                                                                     0,                                                                                                     0,                                                                                                 kpa^2,                                                                                                                  2*g*kpa*qx,                                                                                                                  2*g*kpa*qy,                                                                                                                 -2*g*kpa*qz,                                                                                                                   -2*g*kpa*qw, kpa]
		[ vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz), vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz), vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), (p1y - y)*(2*qw*qz - 2*qx*qy) - (p1x - x)*(qw^2 + qx^2 - qy^2 - qz^2) - (p1z - z)*(2*qw*qy + 2*qx*qz), (p1z - z)*(2*qw*qx - 2*qy*qz) - (p1x - x)*(2*qw*qz + 2*qx*qy) - (p1y - y)*(qw^2 - qx^2 + qy^2 - qz^2), (p1x - x)*(2*qw*qy - 2*qx*qz) - (p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1y - y)*(2*qw*qx + 2*qy*qz), (p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz), (p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy), (p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz), - (p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx),   0]
		[ vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz), vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz), vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), (p2y - y)*(2*qw*qz - 2*qx*qy) - (p2x - x)*(qw^2 + qx^2 - qy^2 - qz^2) - (p2z - z)*(2*qw*qy + 2*qx*qz), (p2z - z)*(2*qw*qx - 2*qy*qz) - (p2x - x)*(2*qw*qz + 2*qx*qy) - (p2y - y)*(qw^2 - qx^2 + qy^2 - qz^2), (p2x - x)*(2*qw*qy - 2*qx*qz) - (p2z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p2y - y)*(2*qw*qx + 2*qy*qz), (p2z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p2x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz), (p2x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p2y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p2z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy), (p2y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p2x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz), - (p2x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p2y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx),   0]
		[ vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz), vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz), vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), (p3y - y)*(2*qw*qz - 2*qx*qy) - (p3x - x)*(qw^2 + qx^2 - qy^2 - qz^2) - (p3z - z)*(2*qw*qy + 2*qx*qz), (p3z - z)*(2*qw*qx - 2*qy*qz) - (p3x - x)*(2*qw*qz + 2*qx*qy) - (p3y - y)*(qw^2 - qx^2 + qy^2 - qz^2), (p3x - x)*(2*qw*qy - 2*qx*qz) - (p3z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p3y - y)*(2*qw*qx + 2*qy*qz), (p3z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p3y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p3x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz), (p3x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p3y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p3z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy), (p3y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p3x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p3z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz), - (p3x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p3y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p3z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx),   0]]

%%%%%------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%%%%%
% Quadrotor does not lie on the line of any two beacons
O3R = [	[ 0, 0, 0, 1, 0, 0,                           0,                           0,                           0,                           0,                                0]
		[ 0, 0, 0, 0, 1, 0,                           0,                           0,                           0,                           0,                                0]
		[ 0, 0, 0, 0, 0, 1,                           0,                           0,                           0,                           0,                            1/kpa]
		[ 1, 0, 0, 0, 0, 0,                           0,                           0,                           0,                           0,                                0]
		[ 0, 1, 0, 0, 0, 0,                           0,                           0,                           0,                           0,                                0]
		[ 0, 0, 1, 0, 0, 0,                           0,                           0,                           0,                           0,                                0]
		[ 0, 0, 0, 0, 0, 0,                     -2*g*qz,                     -2*g*qw,                     -2*g*qx,                     -2*g*qy,                                0]
		[ 0, 0, 0, 0, 0, 0,                      2*g*qw,                     -2*g*qz,                     -2*g*qy,                      2*g*qx,                                0]
		[ 0, 0, 0, 0, 0, 0,                      2*g*qx,                      2*g*qy,                     -2*g*qz,                     -2*g*qw,                                0]
		[ 0, 0, 0, 0, 0, 0, 2*qx*vx + 2*qy*vy + 2*qz*vz, 2*qx*vy - 2*qw*vz - 2*qy*vx, 2*qw*vy + 2*qx*vz - 2*qz*vx, 2*qw*vx - 2*qy*vz + 2*qz*vy,          (2*qw*qy - 2*qx*qz)/kpa]
		[ 0, 0, 0, 0, 0, 0, 2*qw*vz - 2*qx*vy + 2*qy*vx, 2*qx*vx + 2*qy*vy + 2*qz*vz, 2*qy*vz - 2*qw*vx - 2*qz*vy, 2*qw*vy + 2*qx*vz - 2*qz*vx,         -(2*qw*qx + 2*qy*qz)/kpa]
		[ 0, 0, 0, 0, 0, 0, 2*qz*vx - 2*qx*vz - 2*qw*vy, 2*qw*vx - 2*qy*vz + 2*qz*vy, 2*qx*vx + 2*qy*vy + 2*qz*vz, 2*qw*vz - 2*qx*vy + 2*qy*vx, -(qw^2 - qx^2 - qy^2 + qz^2)/kpa]]

% % Quadrotor does not lie on the line of any two beacons : Velocity is zero : Rank defficient
O3R = [	[ 0, 0, 0, 1, 0, 0,       0,       0,       0,       0,                                0]
		[ 0, 0, 0, 0, 1, 0,       0,       0,       0,       0,                                0]
		[ 0, 0, 0, 0, 0, 1,       0,       0,       0,       0,                            1/kpa]
		[ 1, 0, 0, 0, 0, 0,       0,       0,       0,       0,                                0]
		[ 0, 1, 0, 0, 0, 0,       0,       0,       0,       0,                                0]
		[ 0, 0, 1, 0, 0, 0,       0,       0,       0,       0,                                0]
		[ 0, 0, 0, 0, 0, 0, -2*g*qz, -2*g*qw, -2*g*qx, -2*g*qy,                                0]
		[ 0, 0, 0, 0, 0, 0,  2*g*qw, -2*g*qz, -2*g*qy,  2*g*qx,                                0]
		[ 0, 0, 0, 0, 0, 0,  2*g*qx,  2*g*qy, -2*g*qz, -2*g*qw,                                0]
		[ 0, 0, 0, 0, 0, 0,       0,       0,       0,       0,          (2*qw*qy - 2*qx*qz)/kpa]
		[ 0, 0, 0, 0, 0, 0,       0,       0,       0,       0,         -(2*qw*qx + 2*qy*qz)/kpa]
		[ 0, 0, 0, 0, 0, 0,       0,       0,       0,       0, -(qw^2 - qx^2 - qy^2 + qz^2)/kpa]]

% When the quadrotor is flying vertically of v
O3R = [	[ 0, 0, 0, 1, 0, 0,       0,       0,       0,       0,                                0]
		[ 0, 0, 0, 0, 1, 0,       0,       0,       0,       0,                                0]
		[ 0, 0, 0, 0, 0, 1,       0,       0,       0,       0,                            1/kpa]
		[ 1, 0, 0, 0, 0, 0,       0,       0,       0,       0,                                0]
		[ 0, 1, 0, 0, 0, 0,       0,       0,       0,       0,                                0]
		[ 0, 0, 1, 0, 0, 0,       0,       0,       0,       0,                                0]
		[ 0, 0, 0, 0, 0, 0, -2*g*qz, -2*g*qw, -2*g*qx, -2*g*qy,                                0]
		[ 0, 0, 0, 0, 0, 0,  2*g*qw, -2*g*qz, -2*g*qy,  2*g*qx,                                0]
		[ 0, 0, 0, 0, 0, 0,  2*g*qx,  2*g*qy, -2*g*qz, -2*g*qw,                                0]
		[ 0, 0, 0, 0, 0, 0,  2*v*qz, -2*v*qw, -2*v*qx,  2*v*qy,          (2*qw*qy - 2*qx*qz)/kpa]
		[ 0, 0, 0, 0, 0, 0,  2*v*qw,  2*v*qz, -2*v*qy, -2*v*qx,         -(2*qw*qx + 2*qy*qz)/kpa]
		[ 0, 0, 0, 0, 0, 0,  2*v*qx,  2*v*qy,  2*v*qz,  2*v*qw, -(qw^2 - qx^2 - qy^2 + qz^2)/kpa]]
%%%%%------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%%%%%
% When R3 is not invertible i.e: Quadrotor is inbetween any two anchors and then : We have the following conditions 
% When quadrotor lie between two beacons : Full rank, but if k == 1, then rank defficient. This cannot happen since k == 1 means, that beacon 1 and 2 are the same.
O3R = [	[                                                                                0,                                                                                0,                                                                                0, 1, 0, 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 1, 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 1,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                             1/kpa]
		[                                                                          x - p1x,                                                                          y - p1y,                                                                          z - p1z, 0, 0, 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                                 0]
		[                                                                     -k*(p1x - x),                                                                     -k*(p1y - y),                                                                     -k*(p1z - z), 0, 0, 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                                 0]
		[                                                                          x - p3x,                                                                          y - p3y,                                                                          z - p3z, 0, 0, 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                       -2*g*kpp*qz,                                                                                                                       -2*g*kpp*qw,                                                                                                                       -2*g*kpp*qx,                                                                                                                         -2*g*kpp*qy,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                        2*g*kpp*qw,                                                                                                                       -2*g*kpp*qz,                                                                                                                       -2*g*kpp*qy,                                                                                                                          2*g*kpp*qx,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                        2*g*kpa*qx,                                                                                                                        2*g*kpa*qy,                                                                                                                       -2*g*kpa*qz,                                                                                                                         -2*g*kpa*qw,                                                                                                                 0]
		[ vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz), vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz), vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0,       (p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),       (p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),       (p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),       - (p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx),       ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[ vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz), vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz), vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0, k*(p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - k*(p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz), k*(p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - k*(p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - k*(p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy), k*(p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - k*(p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz), - k*(p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - k*(p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), (k*(p1y - y)*(2*qw*qx + 2*qy*qz) - k*(p1x - x)*(2*qw*qy - 2*qx*qz) + k*(p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2))/kpa]
		[ vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz), vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz), vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0,       (p3z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p3y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p3x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),       (p3x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p3y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p3z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),       (p3y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p3x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p3z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),       - (p3x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p3y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p3z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx),       ((p3z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p3x - x)*(2*qw*qy - 2*qx*qz) + (p3y - y)*(2*qw*qx + 2*qy*qz))/kpa]]

% k1r1 = Cvb : The quadrotor is moving towards a beacon (any one of those) : Rank defficient (10)
O3R = [	[            0,            0,            0,                                                                                                        -kpp,                                                                                                           0,                                                                                                           0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,   0]
		[            0,            0,            0,                                                                                                           0,                                                                                                        -kpp,                                                                                                           0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,   0]
		[            0,            0,            0,                                                                                                           0,                                                                                                           0,                                                                                                        -kpa,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,  -1]
		[      x - p1x,      y - p1y,      z - p1z,                                                                                                           0,                                                                                                           0,                                                                                                           0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,   0]
		[ -k*(p1x - x), -k*(p1y - y), -k*(p1z - z),                                                                                                           0,                                                                                                           0,                                                                                                           0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,   0]
		[      x - p3x,      y - p3y,      z - p3z,                                                                                                           0,                                                                                                           0,                                                                                                           0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,   0]
		[            0,            0,            0,                                                                                                       kpp^2,                                                                                                           0,                                                                                                           0,                                                                                                                       -2*g*kpp*qz,                                                                                                                       -2*g*kpp*qw,                                                                                                                       -2*g*kpp*qx,                                                                                                                         -2*g*kpp*qy,   0]
		[            0,            0,            0,                                                                                                           0,                                                                                                       kpp^2,                                                                                                           0,                                                                                                                        2*g*kpp*qw,                                                                                                                       -2*g*kpp*qz,                                                                                                                       -2*g*kpp*qy,                                                                                                                          2*g*kpp*qx,   0]
		[            0,            0,            0,                                                                                                           0,                                                                                                           0,                                                                                                       kpa^2,                                                                                                                        2*g*kpa*qx,                                                                                                                        2*g*kpa*qy,                                                                                                                       -2*g*kpa*qz,                                                                                                                         -2*g*kpa*qw, kpa]
		[            0,            0,            0,       (p1y - y)*(2*qw*qz - 2*qx*qy) - (p1x - x)*(qw^2 + qx^2 - qy^2 - qz^2) - (p1z - z)*(2*qw*qy + 2*qx*qz),       (p1z - z)*(2*qw*qx - 2*qy*qz) - (p1x - x)*(2*qw*qz + 2*qx*qy) - (p1y - y)*(qw^2 - qx^2 + qy^2 - qz^2),       (p1x - x)*(2*qw*qy - 2*qx*qz) - (p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1y - y)*(2*qw*qx + 2*qy*qz),       (p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),       (p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),       (p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),       - (p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx),   0]
		[            0,            0,            0, k*(p1y - y)*(2*qw*qz - 2*qx*qy) - k*(p1z - z)*(2*qw*qy + 2*qx*qz) - k*(p1x - x)*(qw^2 + qx^2 - qy^2 - qz^2), k*(p1z - z)*(2*qw*qx - 2*qy*qz) - k*(p1x - x)*(2*qw*qz + 2*qx*qy) - k*(p1y - y)*(qw^2 - qx^2 + qy^2 - qz^2), k*(p1x - x)*(2*qw*qy - 2*qx*qz) - k*(p1y - y)*(2*qw*qx + 2*qy*qz) - k*(p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2), k*(p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - k*(p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz), k*(p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - k*(p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - k*(p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy), k*(p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - k*(p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz), - k*(p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - k*(p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx),   0]
		[            0,            0,            0,       (p3y - y)*(2*qw*qz - 2*qx*qy) - (p3x - x)*(qw^2 + qx^2 - qy^2 - qz^2) - (p3z - z)*(2*qw*qy + 2*qx*qz),       (p3z - z)*(2*qw*qx - 2*qy*qz) - (p3x - x)*(2*qw*qz + 2*qx*qy) - (p3y - y)*(qw^2 - qx^2 + qy^2 - qz^2),       (p3x - x)*(2*qw*qy - 2*qx*qz) - (p3z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p3y - y)*(2*qw*qx + 2*qy*qz),       (p3z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p3y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p3x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),       (p3x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p3y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p3z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),       (p3y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p3x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p3z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),       - (p3x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p3y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p3z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx),   0]]

% If the velocity is zero : Rank defficient (9)
O3R = [	[            0,            0,            0,                                                                                                        -kpp,                                                                                                           0,                                                                                                           0,           0,           0,           0,           0,   0]
		[            0,            0,            0,                                                                                                           0,                                                                                                        -kpp,                                                                                                           0,           0,           0,           0,           0,   0]
		[            0,            0,            0,                                                                                                           0,                                                                                                           0,                                                                                                        -kpa,           0,           0,           0,           0,  -1]
		[      x - p1x,      y - p1y,      z - p1z,                                                                                                           0,                                                                                                           0,                                                                                                           0,           0,           0,           0,           0,   0]
		[ -k*(p1x - x), -k*(p1y - y), -k*(p1z - z),                                                                                                           0,                                                                                                           0,                                                                                                           0,           0,           0,           0,           0,   0]
		[      x - p3x,      y - p3y,      z - p3z,                                                                                                           0,                                                                                                           0,                                                                                                           0,           0,           0,           0,           0,   0]
		[            0,            0,            0,                                                                                                       kpp^2,                                                                                                           0,                                                                                                           0, -2*g*kpp*qz, -2*g*kpp*qw, -2*g*kpp*qx, -2*g*kpp*qy,   0]
		[            0,            0,            0,                                                                                                           0,                                                                                                       kpp^2,                                                                                                           0,  2*g*kpp*qw, -2*g*kpp*qz, -2*g*kpp*qy,  2*g*kpp*qx,   0]
		[            0,            0,            0,                                                                                                           0,                                                                                                           0,                                                                                                       kpa^2,  2*g*kpa*qx,  2*g*kpa*qy, -2*g*kpa*qz, -2*g*kpa*qw, kpa]
		[            0,            0,            0,       (p1y - y)*(2*qw*qz - 2*qx*qy) - (p1x - x)*(qw^2 + qx^2 - qy^2 - qz^2) - (p1z - z)*(2*qw*qy + 2*qx*qz),       (p1z - z)*(2*qw*qx - 2*qy*qz) - (p1x - x)*(2*qw*qz + 2*qx*qy) - (p1y - y)*(qw^2 - qx^2 + qy^2 - qz^2),       (p1x - x)*(2*qw*qy - 2*qx*qz) - (p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1y - y)*(2*qw*qx + 2*qy*qz),           0,           0,           0,           0,   0]
		[            0,            0,            0, k*(p1y - y)*(2*qw*qz - 2*qx*qy) - k*(p1z - z)*(2*qw*qy + 2*qx*qz) - k*(p1x - x)*(qw^2 + qx^2 - qy^2 - qz^2), k*(p1z - z)*(2*qw*qx - 2*qy*qz) - k*(p1x - x)*(2*qw*qz + 2*qx*qy) - k*(p1y - y)*(qw^2 - qx^2 + qy^2 - qz^2), k*(p1x - x)*(2*qw*qy - 2*qx*qz) - k*(p1y - y)*(2*qw*qx + 2*qy*qz) - k*(p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2),           0,           0,           0,           0,   0]
		[            0,            0,            0,       (p3y - y)*(2*qw*qz - 2*qx*qy) - (p3x - x)*(qw^2 + qx^2 - qy^2 - qz^2) - (p3z - z)*(2*qw*qy + 2*qx*qz),       (p3z - z)*(2*qw*qx - 2*qy*qz) - (p3x - x)*(2*qw*qz + 2*qx*qy) - (p3y - y)*(qw^2 - qx^2 + qy^2 - qz^2),       (p3x - x)*(2*qw*qy - 2*qx*qz) - (p3z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p3y - y)*(2*qw*qx + 2*qy*qz),           0,           0,           0,           0,   0]]

% If the velocity v is in the direction of g : Rank defficient (10)
O3R = [	[            0,            0,            0,                                                                                                        -kpp,                                                                                                           0,                                                                                                           0,                                                      0,                                                     0,                                                     0,                                                      0,   0]
		[            0,            0,            0,                                                                                                           0,                                                                                                        -kpp,                                                                                                           0,                                                      0,                                                     0,                                                     0,                                                      0,   0]
		[            0,            0,            0,                                                                                                           0,                                                                                                           0,                                                                                                        -kpa,                                                      0,                                                     0,                                                     0,                                                      0,  -1]
		[      x - p1x,      y - p1y,      z - p1z,                                                                                                           0,                                                                                                           0,                                                                                                           0,                                                      0,                                                     0,                                                     0,                                                      0,   0]
		[ -k*(p1x - x), -k*(p1y - y), -k*(p1z - z),                                                                                                           0,                                                                                                           0,                                                                                                           0,                                                      0,                                                     0,                                                     0,                                                      0,   0]
		[      x - p3x,      y - p3y,      z - p3z,                                                                                                           0,                                                                                                           0,                                                                                                           0,                                                      0,                                                     0,                                                     0,                                                      0,   0]
		[            0,            0,            0,                                                                                                       kpp^2,                                                                                                           0,                                                                                                           0,                                            -2*g*kpp*qz,                                           -2*g*kpp*qw,                                           -2*g*kpp*qx,                                            -2*g*kpp*qy,   0]
		[            0,            0,            0,                                                                                                           0,                                                                                                       kpp^2,                                                                                                           0,                                             2*g*kpp*qw,                                           -2*g*kpp*qz,                                           -2*g*kpp*qy,                                             2*g*kpp*qx,   0]
		[            0,            0,            0,                                                                                                           0,                                                                                                           0,                                                                                                       kpa^2,                                             2*g*kpa*qx,                                            2*g*kpa*qy,                                           -2*g*kpa*qz,                                            -2*g*kpa*qw, kpa]
		[            0,            0,            v,       (p1y - y)*(2*qw*qz - 2*qx*qy) - (p1x - x)*(qw^2 + qx^2 - qy^2 - qz^2) - (p1z - z)*(2*qw*qy + 2*qx*qz),       (p1z - z)*(2*qw*qx - 2*qy*qz) - (p1x - x)*(2*qw*qz + 2*qx*qy) - (p1y - y)*(qw^2 - qx^2 + qy^2 - qz^2),       (p1x - x)*(2*qw*qy - 2*qx*qz) - (p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1y - y)*(2*qw*qx + 2*qy*qz),   -2*v*(p1y*qw + p1z*qx + p1x*qz - qz*x - qw*y - qx*z),   2*v*(p1x*qw - p1z*qy - p1y*qz - qw*x + qz*y + qy*z),   2*v*(p1x*qx + p1y*qy - p1z*qz - qx*x - qy*y + qz*z),   -2*v*(p1z*qw - p1y*qx + p1x*qy - qy*x + qx*y - qw*z),   0]
		[            0,            0,            v, k*(p1y - y)*(2*qw*qz - 2*qx*qy) - k*(p1z - z)*(2*qw*qy + 2*qx*qz) - k*(p1x - x)*(qw^2 + qx^2 - qy^2 - qz^2), k*(p1z - z)*(2*qw*qx - 2*qy*qz) - k*(p1x - x)*(2*qw*qz + 2*qx*qy) - k*(p1y - y)*(qw^2 - qx^2 + qy^2 - qz^2), k*(p1x - x)*(2*qw*qy - 2*qx*qz) - k*(p1y - y)*(2*qw*qx + 2*qy*qz) - k*(p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2), -2*k*v*(p1y*qw + p1z*qx + p1x*qz - qz*x - qw*y - qx*z), 2*k*v*(p1x*qw - p1z*qy - p1y*qz - qw*x + qz*y + qy*z), 2*k*v*(p1x*qx + p1y*qy - p1z*qz - qx*x - qy*y + qz*z), -2*k*v*(p1z*qw - p1y*qx + p1x*qy - qy*x + qx*y - qw*z),   0]
		[            0,            0,            v,       (p3y - y)*(2*qw*qz - 2*qx*qy) - (p3x - x)*(qw^2 + qx^2 - qy^2 - qz^2) - (p3z - z)*(2*qw*qy + 2*qx*qz),       (p3z - z)*(2*qw*qx - 2*qy*qz) - (p3x - x)*(2*qw*qz + 2*qx*qy) - (p3y - y)*(qw^2 - qx^2 + qy^2 - qz^2),       (p3x - x)*(2*qw*qy - 2*qx*qz) - (p3z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p3y - y)*(2*qw*qx + 2*qy*qz),   -2*v*(p3y*qw + p3z*qx + p3x*qz - qz*x - qw*y - qx*z),   2*v*(p3x*qw - p3z*qy - p3y*qz - qw*x + qz*y + qy*z),   2*v*(p3x*qx + p3y*qy - p3z*qz - qx*x - qy*y + qz*z),   -2*v*(p3z*qw - p3y*qx + p3x*qy - qy*x + qx*y - qw*z),   0]]


%%%%%------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%%%%%
%%%%%------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%%%%%
% Two ranges  : Full rank of 11
O2R = [ [                                                                                                  0,                                                                                                  0,                                                                                                      0, 1, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 1, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 1,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                       1/kpa]
		[                                                                                            x - p1x,                                                                                            y - p1y,                                                                                                z - p1z, 0, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[                                                                                            x - p2x,                                                                                            y - p2y,                                                                                                z - p2z, 0, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                            2*g*qz,                                                                                                                                                                            2*g*qw,                                                                                                                                                                            2*g*qx,                                                                                                                                                                            2*g*qy,                                                                                                           0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                           -2*g*qw,                                                                                                                                                                            2*g*qz,                                                                                                                                                                            2*g*qy,                                                                                                                                                                           -2*g*qx,                                                                                                           0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                           -2*g*qx,                                                                                                                                                                           -2*g*qy,                                                                                                                                                                            2*g*qz,                                                                                                                                                                            2*g*qw,                                                                                                           0]
		[                   vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz),                   vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz),                       vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0,                                                       (p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                       (p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),                                                       (p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                     - (p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[                   vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz),                   vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz),                       vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0,                                                       (p2z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p2x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                       (p2x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p2y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p2z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),                                                       (p2y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p2x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                     - (p2x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p2y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), ((p2z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p2x - x)*(2*qw*qy - 2*qx*qz) + (p2y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[ (2*qw*qy - 2*qx*qz)*(T + kpa*vz) - kpp*vy*(2*qw*qz + 2*qx*qy) - kpp*vx*(qw^2 + qx^2 - qy^2 - qz^2), kpp*vx*(2*qw*qz - 2*qx*qy) - (2*qw*qx + 2*qy*qz)*(T + kpa*vz) - kpp*vy*(qw^2 - qx^2 + qy^2 - qz^2), g - (T + kpa*vz)*(qw^2 - qx^2 - qy^2 + qz^2) - kpp*vx*(2*qw*qy + 2*qx*qz) + kpp*vy*(2*qw*qx - 2*qy*qz), 0, 0, 0, (p1x - x)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) + (p1y - y)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) - (p1z - z)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx), (p1y - y)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) - (p1x - x)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) + (p1z - z)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy), (p1x - x)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) - (p1y - y)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p1z - z)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy), (p1x - x)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p1y - y)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) + (p1z - z)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx),                                                                                                 -(2*vz)/kpa]
		[ (2*qw*qy - 2*qx*qz)*(T + kpa*vz) - kpp*vy*(2*qw*qz + 2*qx*qy) - kpp*vx*(qw^2 + qx^2 - qy^2 - qz^2), kpp*vx*(2*qw*qz - 2*qx*qy) - (2*qw*qx + 2*qy*qz)*(T + kpa*vz) - kpp*vy*(qw^2 - qx^2 + qy^2 - qz^2), g - (T + kpa*vz)*(qw^2 - qx^2 - qy^2 + qz^2) - kpp*vx*(2*qw*qy + 2*qx*qz) + kpp*vy*(2*qw*qx - 2*qy*qz), 0, 0, 0, (p2x - x)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) + (p2y - y)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) - (p2z - z)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx), (p2y - y)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) - (p2x - x)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) + (p2z - z)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy), (p2x - x)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) - (p2y - y)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p2z - z)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy), (p2x - x)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p2y - y)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) + (p2z - z)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx),                                                                                                 -(2*vz)/kpa]];

% kr1 = Cvb :  Full Rank
O2R = [	[                                                                                                  0,                                                                                                  0,                                                                                                      0, 1, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 1, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 1,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                       1/kpa]
		[                                                                                            x - p1x,                                                                                            y - p1y,                                                                                                z - p1z, 0, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[                                                                                            x - p2x,                                                                                            y - p2y,                                                                                                z - p2z, 0, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                            2*g*qz,                                                                                                                                                                            2*g*qw,                                                                                                                                                                            2*g*qx,                                                                                                                                                                            2*g*qy,                                                                                                           0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                           -2*g*qw,                                                                                                                                                                            2*g*qz,                                                                                                                                                                            2*g*qy,                                                                                                                                                                           -2*g*qx,                                                                                                           0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                           -2*g*qx,                                                                                                                                                                           -2*g*qy,                                                                                                                                                                            2*g*qz,                                                                                                                                                                            2*g*qw,                                                                                                           0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                       (p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                       (p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),                                                       (p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                     - (p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                       (p2z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p2x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                       (p2x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p2y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p2z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),                                                       (p2y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p2x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                     - (p2x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p2y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), ((p2z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p2x - x)*(2*qw*qy - 2*qx*qz) + (p2y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[ (2*qw*qy - 2*qx*qz)*(T + kpa*vz) - kpp*vy*(2*qw*qz + 2*qx*qy) - kpp*vx*(qw^2 + qx^2 - qy^2 - qz^2), kpp*vx*(2*qw*qz - 2*qx*qy) - (2*qw*qx + 2*qy*qz)*(T + kpa*vz) - kpp*vy*(qw^2 - qx^2 + qy^2 - qz^2), g - (T + kpa*vz)*(qw^2 - qx^2 - qy^2 + qz^2) - kpp*vx*(2*qw*qy + 2*qx*qz) + kpp*vy*(2*qw*qx - 2*qy*qz), 0, 0, 0, (p1x - x)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) + (p1y - y)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) - (p1z - z)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx), (p1y - y)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) - (p1x - x)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) + (p1z - z)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy), (p1x - x)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) - (p1y - y)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p1z - z)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy), (p1x - x)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p1y - y)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) + (p1z - z)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx),                                                                                                 -(2*vz)/kpa]
		[ (2*qw*qy - 2*qx*qz)*(T + kpa*vz) - kpp*vy*(2*qw*qz + 2*qx*qy) - kpp*vx*(qw^2 + qx^2 - qy^2 - qz^2), kpp*vx*(2*qw*qz - 2*qx*qy) - (2*qw*qx + 2*qy*qz)*(T + kpa*vz) - kpp*vy*(qw^2 - qx^2 + qy^2 - qz^2), g - (T + kpa*vz)*(qw^2 - qx^2 - qy^2 + qz^2) - kpp*vx*(2*qw*qy + 2*qx*qz) + kpp*vy*(2*qw*qx - 2*qy*qz), 0, 0, 0, (p2x - x)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) + (p2y - y)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) - (p2z - z)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx), (p2y - y)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) - (p2x - x)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) + (p2z - z)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy), (p2x - x)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) - (p2y - y)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p2z - z)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy), (p2x - x)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p2y - y)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) + (p2z - z)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx),                                                                                                 -(2*vz)/kpa]]

% kr1 = Cvbdot : Full Rank
O2R = [	[                                                                                0,                                                                                0,                                                                                0, 1, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 1, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 1,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                       1/kpa]
		[                                                                          x - p1x,                                                                          y - p1y,                                                                          z - p1z, 0, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[                                                                          x - p2x,                                                                          y - p2y,                                                                          z - p2z, 0, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                                                                            2*g*qz,                                                                                                                                                                            2*g*qw,                                                                                                                                                                            2*g*qx,                                                                                                                                                                            2*g*qy,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                                                                           -2*g*qw,                                                                                                                                                                            2*g*qz,                                                                                                                                                                            2*g*qy,                                                                                                                                                                           -2*g*qx,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                                                                           -2*g*qx,                                                                                                                                                                           -2*g*qy,                                                                                                                                                                            2*g*qz,                                                                                                                                                                            2*g*qw,                                                                                                           0]
		[ vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz), vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz), vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0,                                                       (p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                       (p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),                                                       (p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                     - (p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[ vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz), vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz), vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0,                                                       (p2z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p2x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                       (p2x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p2y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p2z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),                                                       (p2y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p2x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                     - (p2x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p2y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), ((p2z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p2x - x)*(2*qw*qy - 2*qx*qz) + (p2y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0, (p1x - x)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) + (p1y - y)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) - (p1z - z)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx), (p1y - y)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) - (p1x - x)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) + (p1z - z)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy), (p1x - x)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) - (p1y - y)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p1z - z)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy), (p1x - x)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p1y - y)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) + (p1z - z)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx),                                                                                                 -(2*vz)/kpa]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0, (p2x - x)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) + (p2y - y)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) - (p2z - z)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx), (p2y - y)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) - (p2x - x)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) + (p2z - z)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy), (p2x - x)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) - (p2y - y)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p2z - z)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy), (p2x - x)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p2y - y)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) + (p2z - z)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx),                                                                                                 -(2*vz)/kpa]]

% kr1 = Cvb and k1r1 = Cvbdot : Rank defficient (10) : Quadrotor moves towards a beacon with acceleraton towards that beacon. Or even the acceleration towards the other beacon
O2R = [	[       0,       0,       0, 1, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[       0,       0,       0, 0, 1, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 1,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                       1/kpa]
		[ x - p1x, y - p1y, z - p1z, 0, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[ x - p2x, y - p2y, z - p2z, 0, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                                                                                                                                                            2*g*qz,                                                                                                                                                                            2*g*qw,                                                                                                                                                                            2*g*qx,                                                                                                                                                                            2*g*qy,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                                                                                                                                                           -2*g*qw,                                                                                                                                                                            2*g*qz,                                                                                                                                                                            2*g*qy,                                                                                                                                                                           -2*g*qx,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                                                                                                                                                           -2*g*qx,                                                                                                                                                                           -2*g*qy,                                                                                                                                                                            2*g*qz,                                                                                                                                                                            2*g*qw,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                                       (p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                       (p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),                                                       (p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                     - (p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[       0,       0,       0, 0, 0, 0,                                                       (p2z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p2x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                       (p2x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p2y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p2z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),                                                       (p2y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p2x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                     - (p2x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p2y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), ((p2z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p2x - x)*(2*qw*qy - 2*qx*qz) + (p2y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[       0,       0,       0, 0, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                                                                                                 0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0, (p1x - x)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) + (p1y - y)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) - (p1z - z)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx), (p1y - y)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) - (p1x - x)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) + (p1z - z)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy), (p1x - x)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) - (p1y - y)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p1z - z)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy), (p1x - x)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p1y - y)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) + (p1z - z)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx),                                                                                                 -(2*vz)/kpa]
		[       0,       0,       0, 0, 0, 0, (p2x - x)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) + (p2y - y)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) - (p2z - z)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx), (p2y - y)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) - (p2x - x)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) + (p2z - z)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy), (p2x - x)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) - (p2y - y)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p2z - z)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy), (p2x - x)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p2y - y)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) + (p2z - z)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx),                                                                                                 -(2*vz)/kpa]]


% Velocity is zero  : Full rank of 11
O2R = [ [                     0,                      0,                                 0, 1, 0, 0,                                                      0,                                                      0,                                                      0,                                                      0,                                                                                                           0]
		[                     0,                      0,                                 0, 0, 1, 0,                                                      0,                                                      0,                                                      0,                                                      0,                                                                                                           0]
		[                     0,                      0,                                 0, 0, 0, 1,                                                      0,                                                      0,                                                      0,                                                      0,                                                                                                       1/kpa]
		[               x - p1x,                y - p1y,                           z - p1z, 0, 0, 0,                                                      0,                                                      0,                                                      0,                                                      0,                                                                                                           0]
		[               x - p2x,                y - p2y,                           z - p2z, 0, 0, 0,                                                      0,                                                      0,                                                      0,                                                      0,                                                                                                           0]
		[                     0,                      0,                                 0, 0, 0, 0,                                                 2*g*qz,                                                 2*g*qw,                                                 2*g*qx,                                                 2*g*qy,                                                                                                           0]
		[                     0,                      0,                                 0, 0, 0, 0,                                                -2*g*qw,                                                 2*g*qz,                                                 2*g*qy,                                                -2*g*qx,                                                                                                           0]
		[                     0,                      0,                                 0, 0, 0, 0,                                                -2*g*qx,                                                -2*g*qy,                                                 2*g*qz,                                                 2*g*qw,                                                                                                           0]
		[                     0,                      0,                                 0, 0, 0, 0,                                                      0,                                                      0,                                                      0,                                                      0, ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[                     0,                      0,                                 0, 0, 0, 0,                                                      0,                                                      0,                                                      0,                                                      0, ((p2z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p2x - x)*(2*qw*qy - 2*qx*qz) + (p2y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[                     0,                      0,                                 0, 0, 0, 0,                                                      0,                                                      0,                                                      0,                                                      0,                                                                                                           0]
		[                     0,                      0,                                 0, 0, 0, 0,                                                      0,                                                      0,                                                      0,                                                      0,                                                                                                           0]
		[                     0,                      0,                                 0, 0, 0, 0,                                                      0,                                                      0,                                                      0,                                                      0,                                                                                                           0]
		[ T*(2*qw*qy - 2*qx*qz), -T*(2*qw*qx + 2*qy*qz), g - T*(qw^2 - qx^2 - qy^2 + qz^2), 0, 0, 0, 2*T*qz*(p1x - x) + 2*T*qw*(p1y - y) - 2*T*qx*(p1z - z), 2*T*qz*(p1y - y) - 2*T*qw*(p1x - x) - 2*T*qy*(p1z - z), 2*T*qx*(p1x - x) + 2*T*qy*(p1y - y) + 2*T*qz*(p1z - z), 2*T*qx*(p1y - y) - 2*T*qy*(p1x - x) + 2*T*qw*(p1z - z),                                                                                                           0]
		[ T*(2*qw*qy - 2*qx*qz), -T*(2*qw*qx + 2*qy*qz), g - T*(qw^2 - qx^2 - qy^2 + qz^2), 0, 0, 0, 2*T*qz*(p2x - x) + 2*T*qw*(p2y - y) - 2*T*qx*(p2z - z), 2*T*qz*(p2y - y) - 2*T*qw*(p2x - x) - 2*T*qy*(p2z - z), 2*T*qx*(p2x - x) + 2*T*qy*(p2y - y) + 2*T*qz*(p2z - z), 2*T*qx*(p2y - y) - 2*T*qy*(p2x - x) + 2*T*qw*(p2z - z),                                                                                                           0]]

% vb = 0 and Cvb_dot = k*r1 or Cvb_dot = k*r2  : Rank defficient (10) : Acceleration in the world frame cannot pointed towards a beacon
O2R =  [[       0,       0,       0, 1, 0, 0,                                                      0,                                                      0,                                                      0,                                                      0,                                                                                                           0]
		[       0,       0,       0, 0, 1, 0,                                                      0,                                                      0,                                                      0,                                                      0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 1,                                                      0,                                                      0,                                                      0,                                                      0,                                                                                                       1/kpa]
		[ x - p1x, y - p1y, z - p1z, 0, 0, 0,                                                      0,                                                      0,                                                      0,                                                      0,                                                                                                           0]
		[ x - p2x, y - p2y, z - p2z, 0, 0, 0,                                                      0,                                                      0,                                                      0,                                                      0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                                 2*g*qz,                                                 2*g*qw,                                                 2*g*qx,                                                 2*g*qy,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                                -2*g*qw,                                                 2*g*qz,                                                 2*g*qy,                                                -2*g*qx,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                                -2*g*qx,                                                -2*g*qy,                                                 2*g*qz,                                                 2*g*qw,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                                      0,                                                      0,                                                      0,                                                      0, ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[       0,       0,       0, 0, 0, 0,                                                      0,                                                      0,                                                      0,                                                      0, ((p2z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p2x - x)*(2*qw*qy - 2*qx*qz) + (p2y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[       0,       0,       0, 0, 0, 0,                                                      0,                                                      0,                                                      0,                                                      0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                                      0,                                                      0,                                                      0,                                                      0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                                      0,                                                      0,                                                      0,                                                      0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0, 2*T*qz*(p1x - x) + 2*T*qw*(p1y - y) - 2*T*qx*(p1z - z), 2*T*qz*(p1y - y) - 2*T*qw*(p1x - x) - 2*T*qy*(p1z - z), 2*T*qx*(p1x - x) + 2*T*qy*(p1y - y) + 2*T*qz*(p1z - z), 2*T*qx*(p1y - y) - 2*T*qy*(p1x - x) + 2*T*qw*(p1z - z),                                                                                                           0]
		[       0,       0,       0, 0, 0, 0, 2*T*qz*(p2x - x) + 2*T*qw*(p2y - y) - 2*T*qx*(p2z - z), 2*T*qz*(p2y - y) - 2*T*qw*(p2x - x) - 2*T*qy*(p2z - z), 2*T*qx*(p2x - x) + 2*T*qy*(p2y - y) + 2*T*qz*(p2z - z), 2*T*qx*(p2y - y) - 2*T*qy*(p2x - x) + 2*T*qw*(p2z - z),                                                                                                           0]]

% Acceleration is zero : Full rank 11 vb != 0
O2R = [ [                                                                                0,                                                                                0,                                                                                0, 1, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 1, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 1,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                       1/kpa]
		[                                                                          x - p1x,                                                                          y - p1y,                                                                          z - p1z, 0, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                           0]
		[                                                                          x - p2x,                                                                          y - p2y,                                                                          z - p2z, 0, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                      2*g*qz,                                                                                                                      2*g*qw,                                                                                                                      2*g*qx,                                                                                                                        2*g*qy,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                     -2*g*qw,                                                                                                                      2*g*qz,                                                                                                                      2*g*qy,                                                                                                                       -2*g*qx,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                     -2*g*qx,                                                                                                                     -2*g*qy,                                                                                                                      2*g*qz,                                                                                                                        2*g*qw,                                                                                                           0]
		[ vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz), vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz), vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0, (p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz), (p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy), (p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz), - (p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[ vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz), vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz), vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0, (p2z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p2x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz), (p2x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p2y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p2z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy), (p2y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p2x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz), - (p2x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p2y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), ((p2z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p2x - x)*(2*qw*qy - 2*qx*qz) + (p2y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                 -(2*vz)/kpa]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                 -(2*vz)/kpa]]


% Acceleration is zero and Cvb = r1 or Cvb = k*r2 the rank defficient (10)
O2R = [ [       0,       0,       0, 1, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                           0]
		[       0,       0,       0, 0, 1, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 1,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                       1/kpa]
		[ x - p1x, y - p1y, z - p1z, 0, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                           0]
		[ x - p2x, y - p2y, z - p2z, 0, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                                                                                                      2*g*qz,                                                                                                                      2*g*qw,                                                                                                                      2*g*qx,                                                                                                                        2*g*qy,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                                                                                                     -2*g*qw,                                                                                                                      2*g*qz,                                                                                                                      2*g*qy,                                                                                                                       -2*g*qx,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                                                                                                     -2*g*qx,                                                                                                                     -2*g*qy,                                                                                                                      2*g*qz,                                                                                                                        2*g*qw,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0, (p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz), (p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy), (p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz), - (p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[       0,       0,       0, 0, 0, 0, (p2z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p2x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz), (p2x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p2y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p2z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy), (p2y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p2x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz), - (p2x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p2y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), ((p2z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p2x - x)*(2*qw*qy - 2*qx*qz) + (p2y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[       0,       0,       0, 0, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                 -(2*vz)/kpa]
		[       0,       0,       0, 0, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                 -(2*vz)/kpa]]

% Both velocity and acceleration are zero : Rank defficient (9)
O2R = [	[       0,       0,       0, 1, 0, 0,       0,       0,      0,       0,                                                                                                           0]
		[       0,       0,       0, 0, 1, 0,       0,       0,      0,       0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 1,       0,       0,      0,       0,                                                                                                       1/kpa]
		[ x - p1x, y - p1y, z - p1z, 0, 0, 0,       0,       0,      0,       0,                                                                                                           0]
		[ x - p2x, y - p2y, z - p2z, 0, 0, 0,       0,       0,      0,       0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,  2*g*qz,  2*g*qw, 2*g*qx,  2*g*qy,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0, -2*g*qw,  2*g*qz, 2*g*qy, -2*g*qx,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0, -2*g*qx, -2*g*qy, 2*g*qz,  2*g*qw,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,       0,       0,      0,       0, ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[       0,       0,       0, 0, 0, 0,       0,       0,      0,       0, ((p2z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p2x - x)*(2*qw*qy - 2*qx*qz) + (p2y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[       0,       0,       0, 0, 0, 0,       0,       0,      0,       0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,       0,       0,      0,       0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,       0,       0,      0,       0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,       0,       0,      0,       0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,       0,       0,      0,       0,                                                                                                           0]];

% Body frame accelerations expressed as stand alone variables %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
O2R = [	[                                                                                   0,                                                                                   0,                                                                                   0, 1, 0, 0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                            0,                                                                                                           0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 1, 0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                            0,                                                                                                           0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 1,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                            0,                                                                                                       1/kpa]
		[                                                                             x - p1x,                                                                             y - p1y,                                                                             z - p1z, 0, 0, 0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                            0,                                                                                                           0]
		[                                                                             x - p2x,                                                                             y - p2y,                                                                             z - p2z, 0, 0, 0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                            0,                                                                                                           0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                     2*g*qz,                                                                                                                                                                                     2*g*qw,                                                                                                                                                                                     2*g*qx,                                                                                                                                                                                       2*g*qy,                                                                                                           0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                    -2*g*qw,                                                                                                                                                                                     2*g*qz,                                                                                                                                                                                     2*g*qy,                                                                                                                                                                                      -2*g*qx,                                                                                                           0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                    -2*g*qx,                                                                                                                                                                                    -2*g*qy,                                                                                                                                                                                     2*g*qz,                                                                                                                                                                                       2*g*qw,                                                                                                           0]
		[    vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz),    vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz),    vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0,                                                                (p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                                (p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),                                                                (p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                                - (p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[    vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz),    vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz),    vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0,                                                                (p2z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p2x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                                (p2x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p2y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p2z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),                                                                (p2y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p2x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                                - (p2x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p2y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), ((p2z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p2x - x)*(2*qw*qy - 2*qx*qz) + (p2y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                            0,                                                                                                           0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                            0,                                                                                                           0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                            0,                                                                                                           0]
		[ abx*(qw^2 + qx^2 - qy^2 - qz^2) + aby*(2*qw*qz + 2*qx*qy) - abz*(2*qw*qy - 2*qx*qz), aby*(qw^2 - qx^2 + qy^2 - qz^2) - abx*(2*qw*qz - 2*qx*qy) + abz*(2*qw*qx + 2*qy*qz), abz*(qw^2 - qx^2 - qy^2 + qz^2) + abx*(2*qw*qy + 2*qx*qz) - aby*(2*qw*qx - 2*qy*qz), 0, 0, 0, aby*(qx*(2*p1y - 2*y) - qy*(2*p1x - 2*x) + qw*(2*p1z - 2*z)) - abz*(qz*(2*p1x - 2*x) + qw*(2*p1y - 2*y) - qx*(2*p1z - 2*z)) - abx*(qx*(2*p1x - 2*x) + qy*(2*p1y - 2*y) + qz*(2*p1z - 2*z)), abz*(qw*(2*p1x - 2*x) - qz*(2*p1y - 2*y) + qy*(2*p1z - 2*z)) - abx*(qx*(2*p1y - 2*y) - qy*(2*p1x - 2*x) + qw*(2*p1z - 2*z)) - aby*(qx*(2*p1x - 2*x) + qy*(2*p1y - 2*y) + qz*(2*p1z - 2*z)), abx*(qz*(2*p1x - 2*x) + qw*(2*p1y - 2*y) - qx*(2*p1z - 2*z)) - aby*(qw*(2*p1x - 2*x) - qz*(2*p1y - 2*y) + qy*(2*p1z - 2*z)) - abz*(qx*(2*p1x - 2*x) + qy*(2*p1y - 2*y) + qz*(2*p1z - 2*z)), - abz*(qx*(2*p1y - 2*y) - qy*(2*p1x - 2*x) + qw*(2*p1z - 2*z)) - aby*(qz*(2*p1x - 2*x) + qw*(2*p1y - 2*y) - qx*(2*p1z - 2*z)) - abx*(qw*(2*p1x - 2*x) - qz*(2*p1y - 2*y) + qy*(2*p1z - 2*z)),                                                                                                 -(2*vz)/kpa]
		[ abx*(qw^2 + qx^2 - qy^2 - qz^2) + aby*(2*qw*qz + 2*qx*qy) - abz*(2*qw*qy - 2*qx*qz), aby*(qw^2 - qx^2 + qy^2 - qz^2) - abx*(2*qw*qz - 2*qx*qy) + abz*(2*qw*qx + 2*qy*qz), abz*(qw^2 - qx^2 - qy^2 + qz^2) + abx*(2*qw*qy + 2*qx*qz) - aby*(2*qw*qx - 2*qy*qz), 0, 0, 0, aby*(qx*(2*p2y - 2*y) - qy*(2*p2x - 2*x) + qw*(2*p2z - 2*z)) - abz*(qz*(2*p2x - 2*x) + qw*(2*p2y - 2*y) - qx*(2*p2z - 2*z)) - abx*(qx*(2*p2x - 2*x) + qy*(2*p2y - 2*y) + qz*(2*p2z - 2*z)), abz*(qw*(2*p2x - 2*x) - qz*(2*p2y - 2*y) + qy*(2*p2z - 2*z)) - abx*(qx*(2*p2y - 2*y) - qy*(2*p2x - 2*x) + qw*(2*p2z - 2*z)) - aby*(qx*(2*p2x - 2*x) + qy*(2*p2y - 2*y) + qz*(2*p2z - 2*z)), abx*(qz*(2*p2x - 2*x) + qw*(2*p2y - 2*y) - qx*(2*p2z - 2*z)) - aby*(qw*(2*p2x - 2*x) - qz*(2*p2y - 2*y) + qy*(2*p2z - 2*z)) - abz*(qx*(2*p2x - 2*x) + qy*(2*p2y - 2*y) + qz*(2*p2z - 2*z)), - abz*(qx*(2*p2y - 2*y) - qy*(2*p2x - 2*x) + qw*(2*p2z - 2*z)) - aby*(qz*(2*p2x - 2*x) + qw*(2*p2y - 2*y) - qx*(2*p2z - 2*z)) - abx*(qw*(2*p2x - 2*x) - qz*(2*p2y - 2*y) + qy*(2*p2z - 2*z)),                                                                                                 -(2*vz)/kpa]]

% Body frame acceleration is along the gravity vector :Full rank
O2R = [	[                                                                                   0,                                                                                   0,                                                                                   0, 1, 0, 0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                            0,                                                                                                           0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 1, 0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                            0,                                                                                                           0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 1,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                            0,                                                                                                       1/kpa]
		[                                                                             x - p1x,                                                                             y - p1y,                                                                             z - p1z, 0, 0, 0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                            0,                                                                                                           0]
		[                                                                             x - p2x,                                                                             y - p2y,                                                                             z - p2z, 0, 0, 0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                            0,                                                                                                           0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                     2*g*qz,                                                                                                                                                                                     2*g*qw,                                                                                                                                                                                     2*g*qx,                                                                                                                                                                                       2*g*qy,                                                                                                           0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                    -2*g*qw,                                                                                                                                                                                     2*g*qz,                                                                                                                                                                                     2*g*qy,                                                                                                                                                                                      -2*g*qx,                                                                                                           0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                    -2*g*qx,                                                                                                                                                                                    -2*g*qy,                                                                                                                                                                                     2*g*qz,                                                                                                                                                                                       2*g*qw,                                                                                                           0]
		[                                                                                   0,                                                                                   0,                                                                                   b, 0, 0, 0,                                                                                                                                       -2*b*(p1y*qw + p1z*qx + p1x*qz - qz*x - qw*y - qx*z),                                                                                                                                        2*b*(p1x*qw - p1z*qy - p1y*qz - qw*x + qz*y + qy*z),                                                                                                                                        2*b*(p1x*qx + p1y*qy - p1z*qz - qx*x - qy*y + qz*z),                                                                                                                                         -2*b*(p1z*qw - p1y*qx + p1x*qy - qy*x + qx*y - qw*z), ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[                                                                                   0,                                                                                   0,                                                                                   b, 0, 0, 0,                                                                                                                                       -2*b*(p2y*qw + p2z*qx + p2x*qz - qz*x - qw*y - qx*z),                                                                                                                                        2*b*(p2x*qw - p2z*qy - p2y*qz - qw*x + qz*y + qy*z),                                                                                                                                        2*b*(p2x*qx + p2y*qy - p2z*qz - qx*x - qy*y + qz*z),                                                                                                                                         -2*b*(p2z*qw - p2y*qx + p2x*qy - qy*x + qx*y - qw*z), ((p2z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p2x - x)*(2*qw*qy - 2*qx*qz) + (p2y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                            0,                                                                                                           0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                            0,                                                                                                           0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                          0,                                                                                                                                                                                            0,                                                                                                           0]
		[ abx*(qw^2 + qx^2 - qy^2 - qz^2) + aby*(2*qw*qz + 2*qx*qy) - abz*(2*qw*qy - 2*qx*qz), aby*(qw^2 - qx^2 + qy^2 - qz^2) - abx*(2*qw*qz - 2*qx*qy) + abz*(2*qw*qx + 2*qy*qz), abz*(qw^2 - qx^2 - qy^2 + qz^2) + abx*(2*qw*qy + 2*qx*qz) - aby*(2*qw*qx - 2*qy*qz), 0, 0, 0, aby*(qx*(2*p1y - 2*y) - qy*(2*p1x - 2*x) + qw*(2*p1z - 2*z)) - abz*(qz*(2*p1x - 2*x) + qw*(2*p1y - 2*y) - qx*(2*p1z - 2*z)) - abx*(qx*(2*p1x - 2*x) + qy*(2*p1y - 2*y) + qz*(2*p1z - 2*z)), abz*(qw*(2*p1x - 2*x) - qz*(2*p1y - 2*y) + qy*(2*p1z - 2*z)) - abx*(qx*(2*p1y - 2*y) - qy*(2*p1x - 2*x) + qw*(2*p1z - 2*z)) - aby*(qx*(2*p1x - 2*x) + qy*(2*p1y - 2*y) + qz*(2*p1z - 2*z)), abx*(qz*(2*p1x - 2*x) + qw*(2*p1y - 2*y) - qx*(2*p1z - 2*z)) - aby*(qw*(2*p1x - 2*x) - qz*(2*p1y - 2*y) + qy*(2*p1z - 2*z)) - abz*(qx*(2*p1x - 2*x) + qy*(2*p1y - 2*y) + qz*(2*p1z - 2*z)), - abz*(qx*(2*p1y - 2*y) - qy*(2*p1x - 2*x) + qw*(2*p1z - 2*z)) - aby*(qz*(2*p1x - 2*x) + qw*(2*p1y - 2*y) - qx*(2*p1z - 2*z)) - abx*(qw*(2*p1x - 2*x) - qz*(2*p1y - 2*y) + qy*(2*p1z - 2*z)),                                                                      -(2*b*(qw^2 - qx^2 - qy^2 + qz^2))/kpa]
		[ abx*(qw^2 + qx^2 - qy^2 - qz^2) + aby*(2*qw*qz + 2*qx*qy) - abz*(2*qw*qy - 2*qx*qz), aby*(qw^2 - qx^2 + qy^2 - qz^2) - abx*(2*qw*qz - 2*qx*qy) + abz*(2*qw*qx + 2*qy*qz), abz*(qw^2 - qx^2 - qy^2 + qz^2) + abx*(2*qw*qy + 2*qx*qz) - aby*(2*qw*qx - 2*qy*qz), 0, 0, 0, aby*(qx*(2*p2y - 2*y) - qy*(2*p2x - 2*x) + qw*(2*p2z - 2*z)) - abz*(qz*(2*p2x - 2*x) + qw*(2*p2y - 2*y) - qx*(2*p2z - 2*z)) - abx*(qx*(2*p2x - 2*x) + qy*(2*p2y - 2*y) + qz*(2*p2z - 2*z)), abz*(qw*(2*p2x - 2*x) - qz*(2*p2y - 2*y) + qy*(2*p2z - 2*z)) - abx*(qx*(2*p2y - 2*y) - qy*(2*p2x - 2*x) + qw*(2*p2z - 2*z)) - aby*(qx*(2*p2x - 2*x) + qy*(2*p2y - 2*y) + qz*(2*p2z - 2*z)), abx*(qz*(2*p2x - 2*x) + qw*(2*p2y - 2*y) - qx*(2*p2z - 2*z)) - aby*(qw*(2*p2x - 2*x) - qz*(2*p2y - 2*y) + qy*(2*p2z - 2*z)) - abz*(qx*(2*p2x - 2*x) + qy*(2*p2y - 2*y) + qz*(2*p2z - 2*z)), - abz*(qx*(2*p2y - 2*y) - qy*(2*p2x - 2*x) + qw*(2*p2z - 2*z)) - aby*(qz*(2*p2x - 2*x) + qw*(2*p2y - 2*y) - qx*(2*p2z - 2*z)) - abx*(qw*(2*p2x - 2*x) - qz*(2*p2y - 2*y) + qy*(2*p2z - 2*z)),                                                                      -(2*b*(qw^2 - qx^2 - qy^2 + qz^2))/kpa]]

% Body frame acceleration is along the gravity vector : Full rank : Velocity is not zero and the it is not in the z xirection
O2R = [	[                                                                                0,                                                                                0,                                                                                0, 1, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 1, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 1,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                       1/kpa]
		[                                                                          x - p1x,                                                                          y - p1y,                                                                          z - p1z, 0, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                           0]
		[                                                                          x - p2x,                                                                          y - p2y,                                                                          z - p2z, 0, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                      2*g*qz,                                                                                                                      2*g*qw,                                                                                                                      2*g*qx,                                                                                                                        2*g*qy,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                     -2*g*qw,                                                                                                                      2*g*qz,                                                                                                                      2*g*qy,                                                                                                                       -2*g*qx,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                     -2*g*qx,                                                                                                                     -2*g*qy,                                                                                                                      2*g*qz,                                                                                                                        2*g*qw,                                                                                                           0]
		[ vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz), vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz), vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0, (p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz), (p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy), (p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz), - (p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[ vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz), vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz), vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0, (p2z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p2x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz), (p2x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p2y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p2z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy), (p2y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p2x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz), - (p2x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p2y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p2z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), ((p2z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p2x - x)*(2*qw*qy - 2*qx*qz) + (p2y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                           0,                                                                                                                           0,                                                                                                                           0,                                                                                                                             0,                                                                                                           0]
		[                                                                                0,                                                                                0,                                                                                a, 0, 0, 0,                                                                        -2*a*(p1y*qw + p1z*qx + p1x*qz - qz*x - qw*y - qx*z),                                                                         2*a*(p1x*qw - p1z*qy - p1y*qz - qw*x + qz*y + qy*z),                                                                         2*a*(p1x*qx + p1y*qy - p1z*qz - qx*x - qy*y + qz*z),                                                                          -2*a*(p1z*qw - p1y*qx + p1x*qy - qy*x + qx*y - qw*z),                                                                                                 -(2*vz)/kpa]
		[                                                                                0,                                                                                0,                                                                                a, 0, 0, 0,                                                                        -2*a*(p2y*qw + p2z*qx + p2x*qz - qz*x - qw*y - qx*z),                                                                         2*a*(p2x*qw - p2z*qy - p2y*qz - qw*x + qz*y + qy*z),                                                                         2*a*(p2x*qx + p2y*qy - p2z*qz - qx*x - qy*y + qz*z),                                                                          -2*a*(p2z*qw - p2y*qx + p2x*qy - qy*x + qx*y - qw*z),                                                                                                 -(2*vz)/kpa]]

% Body frame velocity and acceleration are along the gravity vector
O2R = [	[       0,       0,       0, 1, 0, 0,                                                    0,                                                   0,                                                   0,                                                    0,                                                                                                           0]
		[       0,       0,       0, 0, 1, 0,                                                    0,                                                   0,                                                   0,                                                    0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 1,                                                    0,                                                   0,                                                   0,                                                    0,                                                                                                       1/kpa]
		[ x - p1x, y - p1y, z - p1z, 0, 0, 0,                                                    0,                                                   0,                                                   0,                                                    0,                                                                                                           0]
		[ x - p2x, y - p2y, z - p2z, 0, 0, 0,                                                    0,                                                   0,                                                   0,                                                    0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                               2*g*qz,                                              2*g*qw,                                              2*g*qx,                                               2*g*qy,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                              -2*g*qw,                                              2*g*qz,                                              2*g*qy,                                              -2*g*qx,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                              -2*g*qx,                                             -2*g*qy,                                              2*g*qz,                                               2*g*qw,                                                                                                           0]
		[       0,       0,       b, 0, 0, 0, -2*b*(p1y*qw + p1z*qx + p1x*qz - qz*x - qw*y - qx*z), 2*b*(p1x*qw - p1z*qy - p1y*qz - qw*x + qz*y + qy*z), 2*b*(p1x*qx + p1y*qy - p1z*qz - qx*x - qy*y + qz*z), -2*b*(p1z*qw - p1y*qx + p1x*qy - qy*x + qx*y - qw*z), ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[       0,       0,       b, 0, 0, 0, -2*b*(p2y*qw + p2z*qx + p2x*qz - qz*x - qw*y - qx*z), 2*b*(p2x*qw - p2z*qy - p2y*qz - qw*x + qz*y + qy*z), 2*b*(p2x*qx + p2y*qy - p2z*qz - qx*x - qy*y + qz*z), -2*b*(p2z*qw - p2y*qx + p2x*qy - qy*x + qx*y - qw*z), ((p2z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p2x - x)*(2*qw*qy - 2*qx*qz) + (p2y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[       0,       0,       0, 0, 0, 0,                                                    0,                                                   0,                                                   0,                                                    0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                                    0,                                                   0,                                                   0,                                                    0,                                                                                                           0]
		[       0,       0,       0, 0, 0, 0,                                                    0,                                                   0,                                                   0,                                                    0,                                                                                                           0]
		[       0,       0,       a, 0, 0, 0, -2*a*(p1y*qw + p1z*qx + p1x*qz - qz*x - qw*y - qx*z), 2*a*(p1x*qw - p1z*qy - p1y*qz - qw*x + qz*y + qy*z), 2*a*(p1x*qx + p1y*qy - p1z*qz - qx*x - qy*y + qz*z), -2*a*(p1z*qw - p1y*qx + p1x*qy - qy*x + qx*y - qw*z),                                                                                                 -(2*vz)/kpa]
		[       0,       0,       a, 0, 0, 0, -2*a*(p2y*qw + p2z*qx + p2x*qz - qz*x - qw*y - qx*z), 2*a*(p2x*qw - p2z*qy - p2y*qz - qw*x + qz*y + qy*z), 2*a*(p2x*qx + p2y*qy - p2z*qz - qx*x - qy*y + qz*z), -2*a*(p2z*qw - p2y*qx + p2x*qy - qy*x + qx*y - qw*z),                                                                                                 -(2*vz)/kpa]]

%%%%%------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%%%%%
%% Quadrotor is on the line of the two anchors
% r1 = kr2 : Full rank, but if k = 1, then rank defficient (9)
O2R = [	[                                                                                                  0,                                                                                                  0,                                                                                                      0, 1, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 1, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 1,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                             1/kpa]
		[                                                                                            x - p1x,                                                                                            y - p1y,                                                                                                z - p1z, 0, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                       -k*(p1x - x),                                                                                       -k*(p1y - y),                                                                                           -k*(p1z - z), 0, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                  2*g*qz,                                                                                                                                                                                  2*g*qw,                                                                                                                                                                                  2*g*qx,                                                                                                                                                                                  2*g*qy,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                 -2*g*qw,                                                                                                                                                                                  2*g*qz,                                                                                                                                                                                  2*g*qy,                                                                                                                                                                                 -2*g*qx,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                 -2*g*qx,                                                                                                                                                                                 -2*g*qy,                                                                                                                                                                                  2*g*qz,                                                                                                                                                                                  2*g*qw,                                                                                                                 0]
		[                   vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz),                   vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz),                       vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0,                                                             (p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                             (p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),                                                             (p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                           - (p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx),       ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[                   vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz),                   vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz),                       vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0,                                                       k*(p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - k*(p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                       k*(p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - k*(p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - k*(p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),                                                       k*(p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - k*(p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                     - k*(p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - k*(p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), (k*(p1y - y)*(2*qw*qx + 2*qy*qz) - k*(p1x - x)*(2*qw*qy - 2*qx*qz) + k*(p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2))/kpa]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[ (2*qw*qy - 2*qx*qz)*(T + kpa*vz) - kpp*vy*(2*qw*qz + 2*qx*qy) - kpp*vx*(qw^2 + qx^2 - qy^2 - qz^2), kpp*vx*(2*qw*qz - 2*qx*qy) - (2*qw*qx + 2*qy*qz)*(T + kpa*vz) - kpp*vy*(qw^2 - qx^2 + qy^2 - qz^2), g - (T + kpa*vz)*(qw^2 - qx^2 - qy^2 + qz^2) - kpp*vx*(2*qw*qy + 2*qx*qz) + kpp*vy*(2*qw*qx - 2*qy*qz), 0, 0, 0,       (p1x - x)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) + (p1y - y)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) - (p1z - z)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx),       (p1y - y)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) - (p1x - x)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) + (p1z - z)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy),       (p1x - x)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) - (p1y - y)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p1z - z)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy),       (p1x - x)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p1y - y)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) + (p1z - z)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx),                                                                                                       -(2*vz)/kpa]
		[ (2*qw*qy - 2*qx*qz)*(T + kpa*vz) - kpp*vy*(2*qw*qz + 2*qx*qy) - kpp*vx*(qw^2 + qx^2 - qy^2 - qz^2), kpp*vx*(2*qw*qz - 2*qx*qy) - (2*qw*qx + 2*qy*qz)*(T + kpa*vz) - kpp*vy*(qw^2 - qx^2 + qy^2 - qz^2), g - (T + kpa*vz)*(qw^2 - qx^2 - qy^2 + qz^2) - kpp*vx*(2*qw*qy + 2*qx*qz) + kpp*vy*(2*qw*qx - 2*qy*qz), 0, 0, 0, k*(p1x - x)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) + k*(p1y - y)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) - k*(p1z - z)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx), k*(p1y - y)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) - k*(p1x - x)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) + k*(p1z - z)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy), k*(p1x - x)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) - k*(p1y - y)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + k*(p1z - z)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy), k*(p1x - x)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + k*(p1y - y)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) + k*(p1z - z)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx),                                                                                                       -(2*vz)/kpa]]


% vb = 0 : rank defficient (10)
O2R = [ [                     0,                      0,                                 0, 1, 0, 0,                                                            0,                                                            0,                                                            0,                                                            0,                                                                                                                 0]
		[                     0,                      0,                                 0, 0, 1, 0,                                                            0,                                                            0,                                                            0,                                                            0,                                                                                                                 0]
		[                     0,                      0,                                 0, 0, 0, 1,                                                            0,                                                            0,                                                            0,                                                            0,                                                                                                             1/kpa]
		[               x - p1x,                y - p1y,                           z - p1z, 0, 0, 0,                                                            0,                                                            0,                                                            0,                                                            0,                                                                                                                 0]
		[           k*(x - p1x),            k*(y - p1y),                       k*(z - p1z), 0, 0, 0,                                                            0,                                                            0,                                                            0,                                                            0,                                                                                                                 0]
		[                     0,                      0,                                 0, 0, 0, 0,                                                       2*g*qz,                                                       2*g*qw,                                                       2*g*qx,                                                       2*g*qy,                                                                                                                 0]
		[                     0,                      0,                                 0, 0, 0, 0,                                                      -2*g*qw,                                                       2*g*qz,                                                       2*g*qy,                                                      -2*g*qx,                                                                                                                 0]
		[                     0,                      0,                                 0, 0, 0, 0,                                                      -2*g*qx,                                                      -2*g*qy,                                                       2*g*qz,                                                       2*g*qw,                                                                                                                 0]
		[                     0,                      0,                                 0, 0, 0, 0,                                                            0,                                                            0,                                                            0,                                                            0,       ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[                     0,                      0,                                 0, 0, 0, 0,                                                            0,                                                            0,                                                            0,                                                            0, (k*(p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - k*(p1x - x)*(2*qw*qy - 2*qx*qz) + k*(p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[                     0,                      0,                                 0, 0, 0, 0,                                                            0,                                                            0,                                                            0,                                                            0,                                                                                                                 0]
		[                     0,                      0,                                 0, 0, 0, 0,                                                            0,                                                            0,                                                            0,                                                            0,                                                                                                                 0]
		[                     0,                      0,                                 0, 0, 0, 0,                                                            0,                                                            0,                                                            0,                                                            0,                                                                                                                 0]
		[ T*(2*qw*qy - 2*qx*qz), -T*(2*qw*qx + 2*qy*qz), g - T*(qw^2 - qx^2 - qy^2 + qz^2), 0, 0, 0,       2*T*qz*(p1x - x) + 2*T*qw*(p1y - y) - 2*T*qx*(p1z - z),       2*T*qz*(p1y - y) - 2*T*qw*(p1x - x) - 2*T*qy*(p1z - z),       2*T*qx*(p1x - x) + 2*T*qy*(p1y - y) + 2*T*qz*(p1z - z),       2*T*qx*(p1y - y) - 2*T*qy*(p1x - x) + 2*T*qw*(p1z - z),                                                                                                                 0]
		[ T*(2*qw*qy - 2*qx*qz), -T*(2*qw*qx + 2*qy*qz), g - T*(qw^2 - qx^2 - qy^2 + qz^2), 0, 0, 0, 2*T*qz*k*(p1x - x) + 2*T*qw*k*(p1y - y) - 2*T*qx*k*(p1z - z), 2*T*qz*k*(p1y - y) - 2*T*qw*k*(p1x - x) - 2*T*qy*k*(p1z - z), 2*T*qx*k*(p1x - x) + 2*T*qy*k*(p1y - y) + 2*T*qz*k*(p1z - z), 2*T*qx*k*(p1y - y) - 2*T*qy*k*(p1x - x) + 2*T*qw*k*(p1z - z),                                                                                                                 0]]

% Cvb = k1r1 : Rank defficient (10)
O2R = [	[                                                                                                  0,                                                                                                  0,                                                                                                      0, 1, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 1, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 1,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                             1/kpa]
		[                                                                                            x - p1x,                                                                                            y - p1y,                                                                                                z - p1z, 0, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                       -k*(p1x - x),                                                                                       -k*(p1y - y),                                                                                           -k*(p1z - z), 0, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                  2*g*qz,                                                                                                                                                                                  2*g*qw,                                                                                                                                                                                  2*g*qx,                                                                                                                                                                                  2*g*qy,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                 -2*g*qw,                                                                                                                                                                                  2*g*qz,                                                                                                                                                                                  2*g*qy,                                                                                                                                                                                 -2*g*qx,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                 -2*g*qx,                                                                                                                                                                                 -2*g*qy,                                                                                                                                                                                  2*g*qz,                                                                                                                                                                                  2*g*qw,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                             (p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                             (p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),                                                             (p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                           - (p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx),       ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                       k*(p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - k*(p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                       k*(p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - k*(p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - k*(p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),                                                       k*(p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - k*(p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                     - k*(p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - k*(p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), (k*(p1y - y)*(2*qw*qx + 2*qy*qz) - k*(p1x - x)*(2*qw*qy - 2*qx*qz) + k*(p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2))/kpa]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[ (2*qw*qy - 2*qx*qz)*(T + kpa*vz) - kpp*vy*(2*qw*qz + 2*qx*qy) - kpp*vx*(qw^2 + qx^2 - qy^2 - qz^2), kpp*vx*(2*qw*qz - 2*qx*qy) - (2*qw*qx + 2*qy*qz)*(T + kpa*vz) - kpp*vy*(qw^2 - qx^2 + qy^2 - qz^2), g - (T + kpa*vz)*(qw^2 - qx^2 - qy^2 + qz^2) - kpp*vx*(2*qw*qy + 2*qx*qz) + kpp*vy*(2*qw*qx - 2*qy*qz), 0, 0, 0,       (p1x - x)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) + (p1y - y)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) - (p1z - z)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx),       (p1y - y)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) - (p1x - x)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) + (p1z - z)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy),       (p1x - x)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) - (p1y - y)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p1z - z)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy),       (p1x - x)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p1y - y)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) + (p1z - z)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx),                                                                                                       -(2*vz)/kpa]
		[ (2*qw*qy - 2*qx*qz)*(T + kpa*vz) - kpp*vy*(2*qw*qz + 2*qx*qy) - kpp*vx*(qw^2 + qx^2 - qy^2 - qz^2), kpp*vx*(2*qw*qz - 2*qx*qy) - (2*qw*qx + 2*qy*qz)*(T + kpa*vz) - kpp*vy*(qw^2 - qx^2 + qy^2 - qz^2), g - (T + kpa*vz)*(qw^2 - qx^2 - qy^2 + qz^2) - kpp*vx*(2*qw*qy + 2*qx*qz) + kpp*vy*(2*qw*qx - 2*qy*qz), 0, 0, 0, k*(p1x - x)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) + k*(p1y - y)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) - k*(p1z - z)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx), k*(p1y - y)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) - k*(p1x - x)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) + k*(p1z - z)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy), k*(p1x - x)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) - k*(p1y - y)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + k*(p1z - z)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy), k*(p1x - x)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + k*(p1y - y)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) + k*(p1z - z)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx),                                                                                                       -(2*vz)/kpa]]


% vbdot = 0 : rank defficient (10)
O2R = [	[                                                                                0,                                                                                0,                                                                                0, 1, 0, 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 1, 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 1,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                             1/kpa]
		[                                                                          x - p1x,                                                                          y - p1y,                                                                          z - p1z, 0, 0, 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                                 0]
		[                                                                     -k*(p1x - x),                                                                     -k*(p1y - y),                                                                     -k*(p1z - z), 0, 0, 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                            2*g*qz,                                                                                                                            2*g*qw,                                                                                                                            2*g*qx,                                                                                                                              2*g*qy,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                           -2*g*qw,                                                                                                                            2*g*qz,                                                                                                                            2*g*qy,                                                                                                                             -2*g*qx,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                           -2*g*qx,                                                                                                                           -2*g*qy,                                                                                                                            2*g*qz,                                                                                                                              2*g*qw,                                                                                                                 0]
		[ vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz), vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz), vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0,       (p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),       (p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),       (p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),       - (p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx),       ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[ vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz), vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz), vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0, k*(p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - k*(p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz), k*(p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - k*(p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - k*(p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy), k*(p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - k*(p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz), - k*(p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - k*(p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), (k*(p1y - y)*(2*qw*qx + 2*qy*qz) - k*(p1x - x)*(2*qw*qy - 2*qx*qz) + k*(p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2))/kpa]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                       -(2*vz)/kpa]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                       -(2*vz)/kpa]]

% Cvbdot = kr1 : rank defficient (10)
O2R = [	[                                                                                0,                                                                                0,                                                                                0, 1, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 1, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 1,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                             1/kpa]
		[                                                                          x - p1x,                                                                          y - p1y,                                                                          z - p1z, 0, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                     -k*(p1x - x),                                                                     -k*(p1y - y),                                                                     -k*(p1z - z), 0, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                                                                                  2*g*qz,                                                                                                                                                                                  2*g*qw,                                                                                                                                                                                  2*g*qx,                                                                                                                                                                                  2*g*qy,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                                                                                 -2*g*qw,                                                                                                                                                                                  2*g*qz,                                                                                                                                                                                  2*g*qy,                                                                                                                                                                                 -2*g*qx,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                                                                                 -2*g*qx,                                                                                                                                                                                 -2*g*qy,                                                                                                                                                                                  2*g*qz,                                                                                                                                                                                  2*g*qw,                                                                                                                 0]
		[ vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz), vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz), vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0,                                                             (p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                             (p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),                                                             (p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                           - (p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx),       ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[ vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz), vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz), vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0,                                                       k*(p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - k*(p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                       k*(p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - k*(p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - k*(p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),                                                       k*(p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - k*(p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                     - k*(p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - k*(p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), (k*(p1y - y)*(2*qw*qx + 2*qy*qz) - k*(p1x - x)*(2*qw*qy - 2*qx*qz) + k*(p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2))/kpa]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,       (p1x - x)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) + (p1y - y)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) - (p1z - z)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx),       (p1y - y)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) - (p1x - x)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) + (p1z - z)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy),       (p1x - x)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) - (p1y - y)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p1z - z)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy),       (p1x - x)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p1y - y)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) + (p1z - z)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx),                                                                                                       -(2*vz)/kpa]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0, k*(p1x - x)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) + k*(p1y - y)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) - k*(p1z - z)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx), k*(p1y - y)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) - k*(p1x - x)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) + k*(p1z - z)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy), k*(p1x - x)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) - k*(p1y - y)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + k*(p1z - z)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy), k*(p1x - x)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + k*(p1y - y)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) + k*(p1z - z)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx),                                                                                                       -(2*vz)/kpa]]

% Cvb = kg Full rank of 11
O2R = [	[                                                                                                  0,                                                                                                  0,                                                                                                      0, 1, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 1, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 1,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                             1/kpa]
		[                                                                                            x - p1x,                                                                                            y - p1y,                                                                                                z - p1z, 0, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                       -k*(p1x - x),                                                                                       -k*(p1y - y),                                                                                           -k*(p1z - z), 0, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                  2*g*qz,                                                                                                                                                                                  2*g*qw,                                                                                                                                                                                  2*g*qx,                                                                                                                                                                                  2*g*qy,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                 -2*g*qw,                                                                                                                                                                                  2*g*qz,                                                                                                                                                                                  2*g*qy,                                                                                                                                                                                 -2*g*qx,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                 -2*g*qx,                                                                                                                                                                                 -2*g*qy,                                                                                                                                                                                  2*g*qz,                                                                                                                                                                                  2*g*qw,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      v, 0, 0, 0,                                                                                                                                    -2*v*(p1y*qw + p1z*qx + p1x*qz - qz*x - qw*y - qx*z),                                                                                                                                     2*v*(p1x*qw - p1z*qy - p1y*qz - qw*x + qz*y + qy*z),                                                                                                                                     2*v*(p1x*qx + p1y*qy - p1z*qz - qx*x - qy*y + qz*z),                                                                                                                                    -2*v*(p1z*qw - p1y*qx + p1x*qy - qy*x + qx*y - qw*z),       ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[                                                                                                  0,                                                                                                  0,                                                                                                      v, 0, 0, 0,                                                                                                                                  -2*k*v*(p1y*qw + p1z*qx + p1x*qz - qz*x - qw*y - qx*z),                                                                                                                                   2*k*v*(p1x*qw - p1z*qy - p1y*qz - qw*x + qz*y + qy*z),                                                                                                                                   2*k*v*(p1x*qx + p1y*qy - p1z*qz - qx*x - qy*y + qz*z),                                                                                                                                  -2*k*v*(p1z*qw - p1y*qx + p1x*qy - qy*x + qx*y - qw*z), (k*(p1y - y)*(2*qw*qx + 2*qy*qz) - k*(p1x - x)*(2*qw*qy - 2*qx*qz) + k*(p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2))/kpa]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[                                                                                                  0,                                                                                                  0,                                                                                                      0, 0, 0, 0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                                                                                       0,                                                                                                                 0]
		[ (2*qw*qy - 2*qx*qz)*(T + kpa*vz) - kpp*vy*(2*qw*qz + 2*qx*qy) - kpp*vx*(qw^2 + qx^2 - qy^2 - qz^2), kpp*vx*(2*qw*qz - 2*qx*qy) - (2*qw*qx + 2*qy*qz)*(T + kpa*vz) - kpp*vy*(qw^2 - qx^2 + qy^2 - qz^2), g - (T + kpa*vz)*(qw^2 - qx^2 - qy^2 + qz^2) - kpp*vx*(2*qw*qy + 2*qx*qz) + kpp*vy*(2*qw*qx - 2*qy*qz), 0, 0, 0,       (p1x - x)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) + (p1y - y)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) - (p1z - z)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx),       (p1y - y)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) - (p1x - x)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) + (p1z - z)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy),       (p1x - x)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) - (p1y - y)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p1z - z)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy),       (p1x - x)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + (p1y - y)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) + (p1z - z)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx),                                                                                                       -(2*vz)/kpa]
		[ (2*qw*qy - 2*qx*qz)*(T + kpa*vz) - kpp*vy*(2*qw*qz + 2*qx*qy) - kpp*vx*(qw^2 + qx^2 - qy^2 - qz^2), kpp*vx*(2*qw*qz - 2*qx*qy) - (2*qw*qx + 2*qy*qz)*(T + kpa*vz) - kpp*vy*(qw^2 - qx^2 + qy^2 - qz^2), g - (T + kpa*vz)*(qw^2 - qx^2 - qy^2 + qz^2) - kpp*vx*(2*qw*qy + 2*qx*qz) + kpp*vy*(2*qw*qx - 2*qy*qz), 0, 0, 0, k*(p1x - x)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) + k*(p1y - y)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) - k*(p1z - z)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx), k*(p1y - y)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy) - k*(p1x - x)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx) + k*(p1z - z)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy), k*(p1x - x)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) - k*(p1y - y)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + k*(p1z - z)*(2*qz*(T + kpa*vz) + 2*kpp*qx*vx + 2*kpp*qy*vy), k*(p1x - x)*(2*kpp*qw*vx - 2*qy*(T + kpa*vz) + 2*kpp*qz*vy) + k*(p1y - y)*(2*qx*(T + kpa*vz) + 2*kpp*qw*vy - 2*kpp*qz*vx) + k*(p1z - z)*(2*qw*(T + kpa*vz) - 2*kpp*qx*vy + 2*kpp*qy*vx),                                                                                                       -(2*vz)/kpa]]

% Body frame accelerations expressed as stand alone variables %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
O2R = [	[                                                                                   0,                                                                                   0,                                                                                   0, 1, 0, 0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                              0,                                                                                                                 0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 1, 0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                              0,                                                                                                                 0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 1,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                              0,                                                                                                             1/kpa]
		[                                                                             x - p1x,                                                                             y - p1y,                                                                             z - p1z, 0, 0, 0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                              0,                                                                                                                 0]
		[                                                                        -k*(p1x - x),                                                                        -k*(p1y - y),                                                                        -k*(p1z - z), 0, 0, 0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                              0,                                                                                                                 0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                                       2*g*qz,                                                                                                                                                                                                       2*g*qw,                                                                                                                                                                                                       2*g*qx,                                                                                                                                                                                                         2*g*qy,                                                                                                                 0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                                      -2*g*qw,                                                                                                                                                                                                       2*g*qz,                                                                                                                                                                                                       2*g*qy,                                                                                                                                                                                                        -2*g*qx,                                                                                                                 0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                                      -2*g*qx,                                                                                                                                                                                                      -2*g*qy,                                                                                                                                                                                                       2*g*qz,                                                                                                                                                                                                         2*g*qw,                                                                                                                 0]
		[    vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz),    vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz),    vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0,                                                                                  (p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                                                  (p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),                                                                                  (p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                                                  - (p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx),       ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[    vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz),    vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz),    vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0,                                                                            k*(p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - k*(p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                                            k*(p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - k*(p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - k*(p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),                                                                            k*(p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - k*(p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),                                                                            - k*(p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - k*(p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), (k*(p1y - y)*(2*qw*qx + 2*qy*qz) - k*(p1x - x)*(2*qw*qy - 2*qx*qz) + k*(p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2))/kpa]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                              0,                                                                                                                 0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                              0,                                                                                                                 0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                              0,                                                                                                                 0]
		[ abx*(qw^2 + qx^2 - qy^2 - qz^2) + aby*(2*qw*qz + 2*qx*qy) - abz*(2*qw*qy - 2*qx*qz), aby*(qw^2 - qx^2 + qy^2 - qz^2) - abx*(2*qw*qz - 2*qx*qy) + abz*(2*qw*qx + 2*qy*qz), abz*(qw^2 - qx^2 - qy^2 + qz^2) + abx*(2*qw*qy + 2*qx*qz) - aby*(2*qw*qx - 2*qy*qz), 0, 0, 0,                   aby*(qx*(2*p1y - 2*y) - qy*(2*p1x - 2*x) + qw*(2*p1z - 2*z)) - abz*(qz*(2*p1x - 2*x) + qw*(2*p1y - 2*y) - qx*(2*p1z - 2*z)) - abx*(qx*(2*p1x - 2*x) + qy*(2*p1y - 2*y) + qz*(2*p1z - 2*z)),                   abz*(qw*(2*p1x - 2*x) - qz*(2*p1y - 2*y) + qy*(2*p1z - 2*z)) - abx*(qx*(2*p1y - 2*y) - qy*(2*p1x - 2*x) + qw*(2*p1z - 2*z)) - aby*(qx*(2*p1x - 2*x) + qy*(2*p1y - 2*y) + qz*(2*p1z - 2*z)),                   abx*(qz*(2*p1x - 2*x) + qw*(2*p1y - 2*y) - qx*(2*p1z - 2*z)) - aby*(qw*(2*p1x - 2*x) - qz*(2*p1y - 2*y) + qy*(2*p1z - 2*z)) - abz*(qx*(2*p1x - 2*x) + qy*(2*p1y - 2*y) + qz*(2*p1z - 2*z)),                   - abz*(qx*(2*p1y - 2*y) - qy*(2*p1x - 2*x) + qw*(2*p1z - 2*z)) - aby*(qz*(2*p1x - 2*x) + qw*(2*p1y - 2*y) - qx*(2*p1z - 2*z)) - abx*(qw*(2*p1x - 2*x) - qz*(2*p1y - 2*y) + qy*(2*p1z - 2*z)),                                                                                                       -(2*vz)/kpa]
		[ abx*(qw^2 + qx^2 - qy^2 - qz^2) + aby*(2*qw*qz + 2*qx*qy) - abz*(2*qw*qy - 2*qx*qz), aby*(qw^2 - qx^2 + qy^2 - qz^2) - abx*(2*qw*qz - 2*qx*qy) + abz*(2*qw*qx + 2*qy*qz), abz*(qw^2 - qx^2 - qy^2 + qz^2) + abx*(2*qw*qy + 2*qx*qz) - aby*(2*qw*qx - 2*qy*qz), 0, 0, 0, aby*(k*qx*(2*p1y - 2*y) - k*qy*(2*p1x - 2*x) + k*qw*(2*p1z - 2*z)) - abz*(k*qz*(2*p1x - 2*x) + k*qw*(2*p1y - 2*y) - k*qx*(2*p1z - 2*z)) - abx*(k*qx*(2*p1x - 2*x) + k*qy*(2*p1y - 2*y) + k*qz*(2*p1z - 2*z)), abz*(k*qw*(2*p1x - 2*x) - k*qz*(2*p1y - 2*y) + k*qy*(2*p1z - 2*z)) - abx*(k*qx*(2*p1y - 2*y) - k*qy*(2*p1x - 2*x) + k*qw*(2*p1z - 2*z)) - aby*(k*qx*(2*p1x - 2*x) + k*qy*(2*p1y - 2*y) + k*qz*(2*p1z - 2*z)), abx*(k*qz*(2*p1x - 2*x) + k*qw*(2*p1y - 2*y) - k*qx*(2*p1z - 2*z)) - aby*(k*qw*(2*p1x - 2*x) - k*qz*(2*p1y - 2*y) + k*qy*(2*p1z - 2*z)) - abz*(k*qx*(2*p1x - 2*x) + k*qy*(2*p1y - 2*y) + k*qz*(2*p1z - 2*z)), - abz*(k*qx*(2*p1y - 2*y) - k*qy*(2*p1x - 2*x) + k*qw*(2*p1z - 2*z)) - aby*(k*qz*(2*p1x - 2*x) + k*qw*(2*p1y - 2*y) - k*qx*(2*p1z - 2*z)) - abx*(k*qw*(2*p1x - 2*x) - k*qz*(2*p1y - 2*y) + k*qy*(2*p1z - 2*z)),                                                                                                       -(2*vz)/kpa]]

% Velocity and accelerations are along g : Rank 9
O2R = [	[            0,            0,            0, 1, 0, 0,                                                      0,                                                     0,                                                     0,                                                      0,                                                                                                                 0]
		[            0,            0,            0, 0, 1, 0,                                                      0,                                                     0,                                                     0,                                                      0,                                                                                                                 0]
		[            0,            0,            0, 0, 0, 1,                                                      0,                                                     0,                                                     0,                                                      0,                                                                                                             1/kpa]
		[      x - p1x,      y - p1y,      z - p1z, 0, 0, 0,                                                      0,                                                     0,                                                     0,                                                      0,                                                                                                                 0]
		[ -k*(p1x - x), -k*(p1y - y), -k*(p1z - z), 0, 0, 0,                                                      0,                                                     0,                                                     0,                                                      0,                                                                                                                 0]
		[            0,            0,            0, 0, 0, 0,                                                 2*g*qz,                                                2*g*qw,                                                2*g*qx,                                                 2*g*qy,                                                                                                                 0]
		[            0,            0,            0, 0, 0, 0,                                                -2*g*qw,                                                2*g*qz,                                                2*g*qy,                                                -2*g*qx,                                                                                                                 0]
		[            0,            0,            0, 0, 0, 0,                                                -2*g*qx,                                               -2*g*qy,                                                2*g*qz,                                                 2*g*qw,                                                                                                                 0]
		[            0,            0,          2*b, 0, 0, 0,   -2*b*(p1y*qw + p1z*qx + p1x*qz - qz*x - qw*y - qx*z),   2*b*(p1x*qw - p1z*qy - p1y*qz - qw*x + qz*y + qy*z),   2*b*(p1x*qx + p1y*qy - p1z*qz - qx*x - qy*y + qz*z),   -2*b*(p1z*qw - p1y*qx + p1x*qy - qy*x + qx*y - qw*z),       ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[            0,            0,          2*b, 0, 0, 0, -2*b*k*(p1y*qw + p1z*qx + p1x*qz - qz*x - qw*y - qx*z), 2*b*k*(p1x*qw - p1z*qy - p1y*qz - qw*x + qz*y + qy*z), 2*b*k*(p1x*qx + p1y*qy - p1z*qz - qx*x - qy*y + qz*z), -2*b*k*(p1z*qw - p1y*qx + p1x*qy - qy*x + qx*y - qw*z), (k*(p1y - y)*(2*qw*qx + 2*qy*qz) - k*(p1x - x)*(2*qw*qy - 2*qx*qz) + k*(p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2))/kpa]
		[            0,            0,            0, 0, 0, 0,                                                      0,                                                     0,                                                     0,                                                      0,                                                                                                                 0]
		[            0,            0,            0, 0, 0, 0,                                                      0,                                                     0,                                                     0,                                                      0,                                                                                                                 0]
		[            0,            0,            0, 0, 0, 0,                                                      0,                                                     0,                                                     0,                                                      0,                                                                                                                 0]
		[            0,            0,          2*a, 0, 0, 0,   -2*a*(p1y*qw + p1z*qx + p1x*qz - qz*x - qw*y - qx*z),   2*a*(p1x*qw - p1z*qy - p1y*qz - qw*x + qz*y + qy*z),   2*a*(p1x*qx + p1y*qy - p1z*qz - qx*x - qy*y + qz*z),   -2*a*(p1z*qw - p1y*qx + p1x*qy - qy*x + qx*y - qw*z),                                                                            -(2*b*(qw^2 - qx^2 - qy^2 + qz^2))/kpa]
		[            0,            0,          2*a, 0, 0, 0, -2*a*k*(p1y*qw + p1z*qx + p1x*qz - qz*x - qw*y - qx*z), 2*a*k*(p1x*qw - p1z*qy - p1y*qz - qw*x + qz*y + qy*z), 2*a*k*(p1x*qx + p1y*qy - p1z*qz - qx*x - qy*y + qz*z), -2*a*k*(p1z*qw - p1y*qx + p1x*qy - qy*x + qx*y - qw*z),                                                                            -(2*b*(qw^2 - qx^2 - qy^2 + qz^2))/kpa]]

% Velocity along g Rank 11
O2R = [	[                                                                                   0,                                                                                   0,                                                                                   0, 1, 0, 0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                              0,                                                                                                                 0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 1, 0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                              0,                                                                                                                 0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 1,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                              0,                                                                                                             1/kpa]
		[                                                                             x - p1x,                                                                             y - p1y,                                                                             z - p1z, 0, 0, 0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                              0,                                                                                                                 0]
		[                                                                        -k*(p1x - x),                                                                        -k*(p1y - y),                                                                        -k*(p1z - z), 0, 0, 0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                              0,                                                                                                                 0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                                       2*g*qz,                                                                                                                                                                                                       2*g*qw,                                                                                                                                                                                                       2*g*qx,                                                                                                                                                                                                         2*g*qy,                                                                                                                 0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                                      -2*g*qw,                                                                                                                                                                                                       2*g*qz,                                                                                                                                                                                                       2*g*qy,                                                                                                                                                                                                        -2*g*qx,                                                                                                                 0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                                      -2*g*qx,                                                                                                                                                                                                      -2*g*qy,                                                                                                                                                                                                       2*g*qz,                                                                                                                                                                                                         2*g*qw,                                                                                                                 0]
		[                                                                                   0,                                                                                   0,                                                                                   b, 0, 0, 0,                                                                                                                                                         -2*b*(p1y*qw + p1z*qx + p1x*qz - qz*x - qw*y - qx*z),                                                                                                                                                          2*b*(p1x*qw - p1z*qy - p1y*qz - qw*x + qz*y + qy*z),                                                                                                                                                          2*b*(p1x*qx + p1y*qy - p1z*qz - qx*x - qy*y + qz*z),                                                                                                                                                           -2*b*(p1z*qw - p1y*qx + p1x*qy - qy*x + qx*y - qw*z),       ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[                                                                                   0,                                                                                   0,                                                                                   b, 0, 0, 0,                                                                                                                                                       -2*b*k*(p1y*qw + p1z*qx + p1x*qz - qz*x - qw*y - qx*z),                                                                                                                                                        2*b*k*(p1x*qw - p1z*qy - p1y*qz - qw*x + qz*y + qy*z),                                                                                                                                                        2*b*k*(p1x*qx + p1y*qy - p1z*qz - qx*x - qy*y + qz*z),                                                                                                                                                         -2*b*k*(p1z*qw - p1y*qx + p1x*qy - qy*x + qx*y - qw*z), (k*(p1y - y)*(2*qw*qx + 2*qy*qz) - k*(p1x - x)*(2*qw*qy - 2*qx*qz) + k*(p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2))/kpa]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                              0,                                                                                                                 0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                              0,                                                                                                                 0]
		[                                                                                   0,                                                                                   0,                                                                                   0, 0, 0, 0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                            0,                                                                                                                                                                                                              0,                                                                                                                 0]
		[ abx*(qw^2 + qx^2 - qy^2 - qz^2) + aby*(2*qw*qz + 2*qx*qy) - abz*(2*qw*qy - 2*qx*qz), aby*(qw^2 - qx^2 + qy^2 - qz^2) - abx*(2*qw*qz - 2*qx*qy) + abz*(2*qw*qx + 2*qy*qz), abz*(qw^2 - qx^2 - qy^2 + qz^2) + abx*(2*qw*qy + 2*qx*qz) - aby*(2*qw*qx - 2*qy*qz), 0, 0, 0,                   aby*(qx*(2*p1y - 2*y) - qy*(2*p1x - 2*x) + qw*(2*p1z - 2*z)) - abz*(qz*(2*p1x - 2*x) + qw*(2*p1y - 2*y) - qx*(2*p1z - 2*z)) - abx*(qx*(2*p1x - 2*x) + qy*(2*p1y - 2*y) + qz*(2*p1z - 2*z)),                   abz*(qw*(2*p1x - 2*x) - qz*(2*p1y - 2*y) + qy*(2*p1z - 2*z)) - abx*(qx*(2*p1y - 2*y) - qy*(2*p1x - 2*x) + qw*(2*p1z - 2*z)) - aby*(qx*(2*p1x - 2*x) + qy*(2*p1y - 2*y) + qz*(2*p1z - 2*z)),                   abx*(qz*(2*p1x - 2*x) + qw*(2*p1y - 2*y) - qx*(2*p1z - 2*z)) - aby*(qw*(2*p1x - 2*x) - qz*(2*p1y - 2*y) + qy*(2*p1z - 2*z)) - abz*(qx*(2*p1x - 2*x) + qy*(2*p1y - 2*y) + qz*(2*p1z - 2*z)),                   - abz*(qx*(2*p1y - 2*y) - qy*(2*p1x - 2*x) + qw*(2*p1z - 2*z)) - aby*(qz*(2*p1x - 2*x) + qw*(2*p1y - 2*y) - qx*(2*p1z - 2*z)) - abx*(qw*(2*p1x - 2*x) - qz*(2*p1y - 2*y) + qy*(2*p1z - 2*z)),                                                                            -(2*b*(qw^2 - qx^2 - qy^2 + qz^2))/kpa]
		[ abx*(qw^2 + qx^2 - qy^2 - qz^2) + aby*(2*qw*qz + 2*qx*qy) - abz*(2*qw*qy - 2*qx*qz), aby*(qw^2 - qx^2 + qy^2 - qz^2) - abx*(2*qw*qz - 2*qx*qy) + abz*(2*qw*qx + 2*qy*qz), abz*(qw^2 - qx^2 - qy^2 + qz^2) + abx*(2*qw*qy + 2*qx*qz) - aby*(2*qw*qx - 2*qy*qz), 0, 0, 0, aby*(k*qx*(2*p1y - 2*y) - k*qy*(2*p1x - 2*x) + k*qw*(2*p1z - 2*z)) - abz*(k*qz*(2*p1x - 2*x) + k*qw*(2*p1y - 2*y) - k*qx*(2*p1z - 2*z)) - abx*(k*qx*(2*p1x - 2*x) + k*qy*(2*p1y - 2*y) + k*qz*(2*p1z - 2*z)), abz*(k*qw*(2*p1x - 2*x) - k*qz*(2*p1y - 2*y) + k*qy*(2*p1z - 2*z)) - abx*(k*qx*(2*p1y - 2*y) - k*qy*(2*p1x - 2*x) + k*qw*(2*p1z - 2*z)) - aby*(k*qx*(2*p1x - 2*x) + k*qy*(2*p1y - 2*y) + k*qz*(2*p1z - 2*z)), abx*(k*qz*(2*p1x - 2*x) + k*qw*(2*p1y - 2*y) - k*qx*(2*p1z - 2*z)) - aby*(k*qw*(2*p1x - 2*x) - k*qz*(2*p1y - 2*y) + k*qy*(2*p1z - 2*z)) - abz*(k*qx*(2*p1x - 2*x) + k*qy*(2*p1y - 2*y) + k*qz*(2*p1z - 2*z)), - abz*(k*qx*(2*p1y - 2*y) - k*qy*(2*p1x - 2*x) + k*qw*(2*p1z - 2*z)) - aby*(k*qz*(2*p1x - 2*x) + k*qw*(2*p1y - 2*y) - k*qx*(2*p1z - 2*z)) - abx*(k*qw*(2*p1x - 2*x) - k*qz*(2*p1y - 2*y) + k*qy*(2*p1z - 2*z)),                                                                            -(2*b*(qw^2 - qx^2 - qy^2 + qz^2))/kpa]]

% Acceleration along g Rank 10
O2R = [	[                                                                                0,                                                                                0,                                                                                0, 1, 0, 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 1, 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 1,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                             1/kpa]
		[                                                                          x - p1x,                                                                          y - p1y,                                                                          z - p1z, 0, 0, 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                                 0]
		[                                                                     -k*(p1x - x),                                                                     -k*(p1y - y),                                                                     -k*(p1z - z), 0, 0, 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                            2*g*qz,                                                                                                                            2*g*qw,                                                                                                                            2*g*qx,                                                                                                                              2*g*qy,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                           -2*g*qw,                                                                                                                            2*g*qz,                                                                                                                            2*g*qy,                                                                                                                             -2*g*qx,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                           -2*g*qx,                                                                                                                           -2*g*qy,                                                                                                                            2*g*qz,                                                                                                                              2*g*qw,                                                                                                                 0]
		[ vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz), vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz), vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0,       (p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz),       (p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - (p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - (p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy),       (p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz),       - (p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - (p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - (p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx),       ((p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2) - (p1x - x)*(2*qw*qy - 2*qx*qz) + (p1y - y)*(2*qw*qx + 2*qy*qz))/kpa]
		[ vx*(qw^2 + qx^2 - qy^2 - qz^2) + vy*(2*qw*qz + 2*qx*qy) - vz*(2*qw*qy - 2*qx*qz), vy*(qw^2 - qx^2 + qy^2 - qz^2) - vx*(2*qw*qz - 2*qx*qy) + vz*(2*qw*qx + 2*qy*qz), vz*(qw^2 - qx^2 - qy^2 + qz^2) + vx*(2*qw*qy + 2*qx*qz) - vy*(2*qw*qx - 2*qy*qz), 0, 0, 0, k*(p1z - z)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1y - y)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - k*(p1x - x)*(2*qx*vx + 2*qy*vy + 2*qz*vz), k*(p1x - x)*(2*qw*vz - 2*qx*vy + 2*qy*vx) - k*(p1y - y)*(2*qx*vx + 2*qy*vy + 2*qz*vz) - k*(p1z - z)*(2*qw*vx - 2*qy*vz + 2*qz*vy), k*(p1y - y)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - k*(p1x - x)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1z - z)*(2*qx*vx + 2*qy*vy + 2*qz*vz), - k*(p1x - x)*(2*qw*vx - 2*qy*vz + 2*qz*vy) - k*(p1y - y)*(2*qw*vy + 2*qx*vz - 2*qz*vx) - k*(p1z - z)*(2*qw*vz - 2*qx*vy + 2*qy*vx), (k*(p1y - y)*(2*qw*qx + 2*qy*qz) - k*(p1x - x)*(2*qw*qy - 2*qx*qz) + k*(p1z - z)*(qw^2 - qx^2 - qy^2 + qz^2))/kpa]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                0, 0, 0, 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                 0,                                                                                                                                   0,                                                                                                                 0]
		[                                                                                0,                                                                                0,                                                                                a, 0, 0, 0,                                                                              -2*a*(p1y*qw + p1z*qx + p1x*qz - qz*x - qw*y - qx*z),                                                                               2*a*(p1x*qw - p1z*qy - p1y*qz - qw*x + qz*y + qy*z),                                                                               2*a*(p1x*qx + p1y*qy - p1z*qz - qx*x - qy*y + qz*z),                                                                                -2*a*(p1z*qw - p1y*qx + p1x*qy - qy*x + qx*y - qw*z),                                                                                                       -(2*vz)/kpa]
		[                                                                                0,                                                                                0,                                                                                a, 0, 0, 0,                                                                            -2*a*k*(p1y*qw + p1z*qx + p1x*qz - qz*x - qw*y - qx*z),                                                                             2*a*k*(p1x*qw - p1z*qy - p1y*qz - qw*x + qz*y + qy*z),                                                                             2*a*k*(p1x*qx + p1y*qy - p1z*qz - qx*x - qy*y + qz*z),                                                                              -2*a*k*(p1z*qw - p1y*qx + p1x*qy - qy*x + qx*y - qw*z),                                                                                                       -(2*vz)/kpa]]

%%%%%------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%%%%%
%%%%%------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%%%%%
%%%%%------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%%%%%
%%%%%------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%%%%%
%% Three range measurements and the Observability matrix consists of the second order lie derivative
% When R3 is full rank. Then the Gauss eliminated 


Use optitrack data and simulate range measurements and then use it for filter. Then show one actual experiment with actual decawave range measurements to show that it work.